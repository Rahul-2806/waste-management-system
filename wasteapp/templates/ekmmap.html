<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ernakulam Smart Waste Management System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.3/leaflet.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.6.1/nouislider.min.css" />
    <style>
        /* ===== ROOT VARIABLES ===== */
        :root {
            --primary-color: #4CAF50;
            --primary-dark: #2E7D32;
            --primary-light: #8BC34A;
            --primary-very-light: #f1f8e9;
            --accent-color: #FF5722;
            --warning-color: #FFA000;
            --info-color: #2196F3;
            --success-color: #4CAF50;
            --text-color: #33691E;
            --text-light: #689F38;
            --background-color: #f0f7f0;
            --card-background: white;
            --border-color: #c5e1a5;
            --shadow-color: rgba(0, 0, 0, 0.1);
            --transition-speed: 0.3s;
            --border-radius-sm: 4px;
            --border-radius-md: 8px;
            --border-radius-lg: 16px;
            --spacing-xs: 5px;
            --spacing-sm: 10px;
            --spacing-md: 15px;
            --spacing-lg: 20px;
            --font-size-xs: 0.7rem;
            --font-size-sm: 0.85rem;
            --font-size-md: 1rem;
            --font-size-lg: 1.2rem;
            --font-size-xl: 1.5rem;
        }
        
        .dark-mode {
            --primary-color: #388E3C;
            --primary-dark: #1B5E20;
            --primary-light: #66BB6A;
            --primary-very-light: #1c241c;
            --accent-color: #FF7043;
            --warning-color: #FFB300;
            --info-color: #42A5F5;
            --success-color: #43A047;
            --text-color: #DCEDC8;
            --text-light: #AED581;
            --background-color: #121212;
            --card-background: #1E1E1E;
            --border-color: #388E3C;
            --shadow-color: rgba(0, 0, 0, 0.3);
        }
        
        /* ===== RESET & GENERAL STYLES ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: background-color var(--transition-speed), color var(--transition-speed), border-color var(--transition-speed);
        }
        
        body {
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
            background-color: var(--background-color);
            color: var(--text-color);
        }
        
        /* Button and form styles */
        button, 
        .btn {
            padding: var(--spacing-sm) var(--spacing-md);
            border-radius: var(--border-radius-md);
            border: none;
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 2px 5px var(--shadow-color);
        }
        
        button:hover,
        .btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px var(--shadow-color);
        }
        
        button:active,
        .btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px var(--shadow-color);
        }
        
        button.secondary {
            background-color: var(--primary-light);
        }
        
        button.accent {
            background-color: var(--accent-color);
        }
        
        button.small {
            padding: 5px 10px;
            font-size: var(--font-size-sm);
        }
        
        input, select, textarea {
            width: 100%;
            padding: var(--spacing-sm) var(--spacing-md);
            border-radius: var(--border-radius-md);
            border: 1px solid var(--border-color);
            background-color: var(--primary-very-light);
            color: var(--text-color);
            transition: all 0.2s;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary-light);
            box-shadow: 0 0 0 3px rgba(139, 195, 74, 0.2);
        }
        
        /* ===== LAYOUT COMPONENTS ===== */
        header {
            background-color: var(--primary-color);
            color: white;
            padding: 1rem;
            box-shadow: 0 2px 8px var(--shadow-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            z-index: 900;
        }
        
        .header-left {
            flex: 1;
            display: flex;
            align-items: center;
        }
        
        .logo {
            width: 40px;
            height: 40px;
            margin-right: 15px;
            background-color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: transform 0.3s ease;
        }
        
        .logo:hover {
            transform: rotate(360deg) scale(1.1);
        }
        
        .logo i {
            font-size: 20px;
            color: var(--primary-color);
        }
        
        h1 {
            font-size: 1.5rem;
            margin-bottom: 0.3rem;
            font-weight: 700;
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }
        
        .subtitle {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .header-button {
            background-color: rgba(255, 255, 255, 0.2);
            padding: 0.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }
        
        .header-button:hover {
            background-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--accent-color);
            color: white;
            font-size: 0.7rem;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            animation: pulse 2s infinite;
        }
        
        .iot-status {
            background-color: rgba(255, 255, 255, 0.2);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            margin-right: 1rem;
            display: flex;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }
        
        .iot-status:hover {
            background-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: #8BC34A;
            margin-right: 8px;
            animation: pulse 2s infinite;
        }
        
        .map-container {
            flex: 1;
            position: relative;
            display: flex;
            overflow: hidden;
        }
        
        #map {
            flex: 1;
            z-index: 1;
            transition: filter 0.5s;
        }
        
        .sidebar {
            width: 350px;
            background-color: var(--card-background);
            box-shadow: -2px 0 10px var(--shadow-color);
            z-index: 800;
            padding: 1rem;
            overflow-y: auto;
            transition: transform 0.3s ease, width 0.3s ease, background-color var(--transition-speed);
            border-left: 1px solid var(--border-color);
        }
        
        .sidebar-toggle {
            position: absolute;
            top: 10px;
            right: 360px;
            z-index: 801;
            background: var(--card-background);
            border: none;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 5px var(--shadow-color);
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .sidebar-toggle:hover {
            background-color: var(--primary-very-light);
            transform: scale(1.1);
        }
        
        .sidebar.collapsed {
            transform: translateX(100%);
        }
        
        .controls {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 750;
            background: var(--card-background);
            padding: 15px;
            border-radius: var(--border-radius-lg);
            box-shadow: 0 3px 10px var(--shadow-color);
            max-width: 300px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }
        
        .controls:hover {
            box-shadow: 0 5px 15px var(--shadow-color);
        }
        
        .control-item {
            margin-bottom: 15px;
        }
        
        .control-item:last-child {
            margin-bottom: 0;
        }
        
        .control-item label {
            display: block;
            margin-bottom: 6px;
            font-size: 0.8rem;
            font-weight: bold;
            color: var(--text-color);
        }
        
        .places-list {
            margin-top: 10px;
            max-height: 180px;
            overflow-y: auto;
            border-top: 1px solid var(--border-color);
            padding-top: 8px;
            border-radius: 4px;
        }
        
        .place-item {
            padding: 10px;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            font-size: 0.85rem;
            color: var(--text-color);
            transition: all 0.2s;
            display: flex;
            align-items: center;
            border-radius: 4px;
        }
        
        .place-item:hover {
            background-color: var(--primary-very-light);
            transform: translateX(5px);
        }
        
        .place-item i {
            margin-right: 10px;
            color: var(--text-light);
            transition: transform 0.2s;
        }
        
        .place-item:hover i {
            transform: scale(1.2);
        }
        
        footer {
            background-color: var(--primary-very-light);
            padding: 0.7rem 1rem;
            font-size: 0.8rem;
            color: var(--text-color);
            text-align: center;
            border-top: 1px solid var(--border-color);
            position: relative;
            z-index: 5;
        }
        
        .legend {
            position: absolute;
            bottom: 20px;
            left: 10px;
            z-index: 700;
            background: var(--card-background);
            padding: 12px;
            border-radius: var(--border-radius-lg);
            box-shadow: 0 3px 10px var(--shadow-color);
            font-size: 0.8rem;
            border: 1px solid var(--border-color);
            color: var(--text-color);
            max-width: 220px;
            transition: all 0.3s ease;
        }
        
        .legend:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px var(--shadow-color);
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            margin-right: 8px;
            box-shadow: 0 2px 3px rgba(0,0,0,0.1);
        }
        
        /* ===== BIN POPUP STYLES ===== */
        .bin-popup {
            font-size: 0.9rem;
            line-height: 1.5;
            min-width: 280px;
        }
        
        .bin-popup h3 {
            color: var(--primary-dark);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 1.2rem;
            border-bottom: 2px solid var(--primary-light);
            padding-bottom: 8px;
        }
        
        .bin-popup h3 i {
            color: var(--text-light);
            font-size: 1.1rem;
        }
        
        .bin-popup p {
            margin-bottom: 7px;
            color: var(--text-color);
        }
        
        .bin-popup span.badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            color: white;
            margin-right: 4px;
            margin-top: 5px;
            box-shadow: 0 2px 3px rgba(0,0,0,0.1);
            transition: all 0.2s;
        }
        
        .bin-popup span.badge:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0,0,0,0.15);
        }
        
        .bin-popup .status {
            font-weight: bold;
        }
        
        .bin-popup .progress-bar {
            height: 10px;
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 5px;
            margin-top: 5px;
            overflow: hidden;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .bin-popup .progress-fill {
            height: 100%;
            background-color: var(--primary-light);
            transition: width 1s ease-out;
            position: relative;
        }
        
        .bin-popup .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(
                45deg,
                rgba(255,255,255,0.2) 25%,
                transparent 25%,
                transparent 50%,
                rgba(255,255,255,0.2) 50%,
                rgba(255,255,255,0.2) 75%,
                transparent 75%,
                transparent
            );
            background-size: 15px 15px;
            animation: progressAnimation 1s linear infinite;
            border-radius: 5px;
        }
        
        .status-icon {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 6px;
        }
        
        .bin-controls {
            display: flex;
            margin-top: 12px;
            gap: 8px;
        }
        
        .bin-controls button {
            flex: 1;
            padding: 8px;
            font-size: 0.8rem;
        }
        
        /* ===== TAB STYLES ===== */
        .tab-buttons {
            display: flex;
            margin-bottom: 1.3rem;
            border-bottom: 1px solid var(--border-color);
            position: relative;
        }
        
        .tab-button {
            padding: 10px 20px;
            background: none;
            border: none;
            color: var(--text-light);
            font-weight: bold;
            cursor: pointer;
            opacity: 0.7;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            box-shadow: none;
        }
        
        .tab-button::before {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 50%;
            width: 0;
            height: 3px;
            background-color: var(--primary-color);
            transition: all 0.3s;
            transform: translateX(-50%);
        }
        
        .tab-button:hover {
            background: none;
            box-shadow: none;
            transform: none;
        }
        
        .tab-button:hover::before {
            width: 80%;
        }
        
        .tab-button.active {
            opacity: 1;
            color: var(--primary-dark);
        }
        
        .tab-button.active::before {
            width: 100%;
        }
        
        .tab-content {
            display: none;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s;
        }
        
        .tab-content.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
            animation: fadeIn 0.5s;
        }
        
        /* ===== DASHBOARD STYLES ===== */
        .dashboard {
            padding: 1rem;
        }
        
        .dashboard h2 {
            color: var(--primary-dark);
            margin-bottom: 1.3rem;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            position: relative;
            padding-bottom: 10px;
        }
        
        .dashboard h2::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 50px;
            height: 3px;
            background-color: var(--primary-color);
            border-radius: 3px;
            transition: width 0.3s;
        }
        
        .dashboard h2:hover::after {
            width: 100px;
        }
        
        .dashboard h2 i {
            margin-right: 10px;
            background-color: var(--primary-very-light);
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            color: var(--primary-color);
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 1.8rem;
        }
        
        .stats.stats-4 {
            grid-template-columns: repeat(2, 1fr);
        }
        
        .stats.stats-6 {
            grid-template-columns: repeat(3, 1fr);
        }
        
        .stat-card {
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg);
            padding: 16px;
            text-align: center;
            box-shadow: 0 3px 10px var(--shadow-color);
            transition: all 0.3s;
            border: 1px solid rgba(0,0,0,0.05);
            position: relative;
            overflow: hidden;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px var(--shadow-color);
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            width: 40px;
            height: 40px;
            background-color: var(--primary-very-light);
            border-radius: 50%;
            z-index: 0;
            transition: all 0.5s;
        }
        
        .stat-card:hover::before {
            transform: scale(6);
            opacity: 0.1;
        }
        
        .stat-card .stat-icon {
            font-size: 1.3rem;
            margin-bottom: 10px;
            color: var(--primary-color);
            position: relative;
            z-index: 1;
        }
        
        .stat-card .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary-dark);
            margin: 5px 0;
            position: relative;
            z-index: 1;
        }
        
        .stat-card .stat-label {
            font-size: 0.8rem;
            color: var(--text-light);
            position: relative;
            z-index: 1;
        }
        
        /* ===== NOTIFICATIONS STYLES ===== */
        .notifications {
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg);
            padding: 1rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 3px 10px var(--shadow-color);
            max-height: 300px;
            overflow-y: auto;
        }
        
        .notification-item {
            padding: 12px;
            border-bottom: 1px solid var(--border-color);
            font-size: 0.9rem;
            transition: all 0.2s;
            border-radius: 6px;
            margin-bottom: 5px;
            animation-duration: 0.5s;
        }
        
        .notification-item:hover {
            background-color: var(--primary-very-light);
            transform: translateX(5px);
        }
        
        .notification-item:last-child {
            border-bottom: none;
        }
        
        .notification-item .time {
            font-size: 0.8rem;
            color: #757575;
            display: flex;
            align-items: center;
            margin-top: 5px;
        }
        
        .notification-item .time i {
            margin-right: 4px;
            font-size: 0.75rem;
        }
        
        .notification-item.urgent {
            border-left: 3px solid var(--accent-color);
            background-color: rgba(255, 87, 34, 0.08);
        }
        
        .notification-item.warning {
            border-left: 3px solid var(--warning-color);
            background-color: rgba(255, 160, 0, 0.08);
        }
        
        .notification-item.info {
            border-left: 3px solid var(--info-color);
            background-color: rgba(33, 150, 243, 0.08);
        }
        
        .notification-item.success {
            border-left: 3px solid var(--success-color);
            background-color: rgba(76, 175, 80, 0.08);
        }
        
        .alerts-title {
            font-size: 1rem;
            margin-bottom: 15px;
            color: var(--text-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .alerts-title span {
            display: flex;
            align-items: center;
        }
        
        .alerts-title i {
            margin-right: 8px;
            color: var(--accent-color);
        }
        
        .alerts-title .count {
            background-color: var(--accent-color);
            color: white;
            border-radius: 12px;
            padding: 2px 8px;
            font-size: 0.8rem;
            animation: pulse 2s infinite;
        }
        
        /* ===== BIN LIST STYLES ===== */
        .bin-list {
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg);
            padding: 1rem;
            box-shadow: 0 3px 10px var(--shadow-color);
            max-height: 350px;
            overflow-y: auto;
        }
        
        .bin-list-title {
            font-size: 1rem;
            margin-bottom: 15px;
            color: var(--text-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .bin-list-title i {
            margin-right: 8px;
            color: var(--primary-color);
        }
        
        .bin-list-item {
            padding: 12px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s;
            border-radius: 6px;
        }
        
        .bin-list-item:hover {
            background-color: var(--primary-very-light);
            transform: translateX(5px);
        }
        
        .bin-list-item:last-child {
            border-bottom: none;
        }
        
        .bin-list-item .bin-name {
            font-weight: bold;
            color: var(--text-color);
            font-size: 0.9rem;
            flex: 1;
        }
        
        .bin-list-item .bin-status {
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            color: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            min-width: 50px;
            text-align: center;
        }
        
        .bin-status.critical {
            background-color: var(--accent-color);
            animation: pulse 2s infinite;
        }
        
        .bin-status.warning {
            background-color: var(--warning-color);
        }
        
        .bin-status.good {
            background-color: var(--primary-color);
        }
        
        /* ===== FILTER CHIPS STYLES ===== */
        .filter-chips {
            display: flex;
            flex-wrap: wrap;
            margin: 10px 0 15px;
            gap: 8px;
        }
        
        .filter-chip {
            background-color: var(--primary-very-light);
            border: 1px solid var(--border-color);
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            color: var(--text-color);
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: all 0.2s;
            box-shadow: 0 1px 3px var(--shadow-color);
        }
        
        .filter-chip:hover {
            transform: translateY(-2px);
            box-shadow: 0 3px 6px var(--shadow-color);
        }
        
        .filter-chip.active {
            background-color: var(--primary-light);
            color: white;
            border-color: var(--primary-dark);
            box-shadow: 0 2px 5px rgba(139, 195, 74, 0.3);
            transform: scale(1.05);
        }
        
        .filter-chip i {
            margin-right: 5px;
        }
        
        /* ===== ADDITIONAL UI COMPONENTS ===== */
        .prediction-panel {
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg);
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 3px 10px var(--shadow-color);
            transition: all 0.3s;
            border: 1px solid var(--border-color);
        }
        
        .prediction-panel:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px var(--shadow-color);
        }
        
        .prediction-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .prediction-title {
            font-size: 1rem;
            font-weight: bold;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .prediction-refresh {
            background: none;
            border: none;
            color: var(--primary-color);
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .prediction-refresh:hover {
            transform: rotate(180deg);
        }
        
        .prediction-content {
            background-color: var(--primary-very-light);
            border-radius: var(--border-radius-md);
            padding: 10px;
        }
        
        .prediction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .prediction-item:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }
        
        .prediction-bin {
            font-weight: bold;
            color: var(--text-color);
            font-size: 0.9rem;
        }
        
        .prediction-time {
            font-size: 0.8rem;
            color: var(--accent-color);
            background-color: rgba(255, 87, 34, 0.1);
            padding: 3px 8px;
            border-radius: 10px;
        }
        
        .stats-timeline {
            height: 200px;
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg);
            margin-bottom: 1.5rem;
            padding: 15px;
            box-shadow: 0 3px 10px var(--shadow-color);
            transition: all 0.3s;
            border: 1px solid rgba(0,0,0,0.05);
        }
        
        .stats-timeline:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px var(--shadow-color);
        }
        
        .map-mode-switch {
            position: absolute;
            top: 70px;
            left: 10px;
            z-index: 699;
            background-color: var(--card-background);
            border-radius: 20px;
            display: flex;
            overflow: hidden;
            box-shadow: 0 3px 10px var(--shadow-color);
            border: 1px solid var(--border-color);
        }
        
        .map-mode-option {
            padding: 8px 15px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .map-mode-option.active {
            background-color: var(--primary-color);
            color: white;
        }
        
        .map-mode-option:hover:not(.active) {
            background-color: var(--primary-very-light);
        }
        
        .heatmap-toggle {
            position: absolute;
            top: 110px;
            left: 10px;
            z-index: 698;
            background-color: var(--card-background);
            border-radius: 20px;
            padding: 8px 15px;
            font-size: 0.8rem;
            cursor: pointer;
            box-shadow: 0 3px 10px var(--shadow-color);
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--text-color);
            transition: all 0.3s;
            border: 1px solid var(--border-color);
        }
        
        .heatmap-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 12px var(--shadow-color);
        }
        
        .heatmap-toggle.active {
            background-color: var(--primary-color);
            color: white;
        }
        
        .community-panel {
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg);
            padding: 15px;
            margin-top: 20px;
            box-shadow: 0 3px 10px var(--shadow-color);
            transition: all 0.3s;
            border: 1px solid var(--border-color);
        }
        
        .community-panel:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px var(--shadow-color);
        }
        
        .community-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .community-title {
            font-size: 1rem;
            font-weight: bold;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .report-btn {
            background-color: var(--primary-light);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 5px 12px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .report-btn:hover {
            background-color: var(--primary-color);
            transform: translateY(-2px);
        }
        
        .community-reports {
            max-height: 150px;
            overflow-y: auto;
        }
        
        .report-item {
            display: flex;
            gap: 10px;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .report-item:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }
        
        .report-avatar {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: var(--primary-very-light);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-color);
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .report-content {
            flex: 1;
        }
        
        .report-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            margin-bottom: 5px;
        }
        
        .report-user {
            font-weight: bold;
            color: var(--text-color);
        }
        
        .report-time {
            color: var(--text-light);
        }
        
        .report-text {
            font-size: 0.85rem;
            color: var(--text-color);
        }
        
        .report-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 5px;
        }
        
        .report-action {
            font-size: 0.8rem;
            color: var(--primary-color);
            cursor: pointer;
        }
        
        .report-action:hover {
            text-decoration: underline;
        }
        
        .weather-widget {
            position: absolute;
            top: 70px;
            right: 10px;
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg);
            padding: 15px;
            width: 200px;
            box-shadow: 0 3px 10px var(--shadow-color);
            z-index: 697;
            transition: all 0.3s;
            border: 1px solid var(--border-color);
        }
        
        .weather-widget:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px var(--shadow-color);
        }
        
        .weather-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .weather-icon {
            font-size: 2rem;
            color: var(--primary-color);
        }
        
        .weather-temp {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--text-color);
        }
        
        .weather-desc {
            font-size: 0.8rem;
            color: var(--text-light);
            margin-bottom: 10px;
        }
        
        .weather-details {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: var(--text-color);
        }
        
        .weather-details div {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .weather-details i {
            margin-bottom: 5px;
            color: var(--text-light);
        }
        
        /* ===== TIMELINE COMPONENT ===== */
        .timeline {
            position: relative;
            padding: 20px 0;
        }
        
        .timeline:before {
            content: '';
            position: absolute;
            top: 0;
            left: 15px;
            height: 100%;
            width: 2px;
            background-color: var(--border-color);
        }
        
        .timeline-item {
            position: relative;
            padding-left: 40px;
            padding-bottom: 20px;
        }
        
        .timeline-item:last-child {
            padding-bottom: 0;
        }
        
        .timeline-dot {
            position: absolute;
            left: 8px;
            top: 0;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background-color: var(--primary-color);
            border: 2px solid var(--card-background);
            z-index: 1;
        }
        
        .timeline-content {
            background-color: var(--primary-very-light);
            padding: 12px;
            border-radius: 8px;
            box-shadow: 0 2px 5px var(--shadow-color);
        }
        
        .timeline-title {
            font-weight: bold;
            font-size: 0.9rem;
            color: var(--text-color);
            margin-bottom: 5px;
        }
        
        .timeline-date {
            font-size: 0.8rem;
            color: var(--text-light);
            margin-bottom: 8px;
        }
        
        .timeline-text {
            font-size: 0.85rem;
            color: var(--text-color);
        }
        
        /* ===== MODAL & OVERLAY STYLES ===== */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 999;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        
        .dark-mode .loading-overlay {
            background-color: rgba(18, 18, 18, 0.9);
        }
        
        .loading-overlay.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .spinner-container {
            position: relative;
            width: 100px;
            height: 100px;
        }
        
        .spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(76, 175, 80, 0.2);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: spin 1s linear infinite;
        }
        
        .spinner:before {
            content: '';
            position: absolute;
            top: -5px;
            left: -5px;
            right: -5px;
            bottom: -5px;
            border: 5px solid transparent;
            border-radius: 50%;
            border-top-color: var(--primary-light);
            opacity: 0.6;
            animation: spin 2s linear infinite;
        }
        
        .spinner:after {
            content: '';
            position: absolute;
            top: 5px;
            left: 5px;
            right: 5px;
            bottom: 5px;
            border: 5px solid transparent;
            border-radius: 50%;
            border-top-color: var(--primary-dark);
            opacity: 0.6;
            animation: spin 1.5s linear infinite reverse;
        }
        
        .loading-text {
            margin-top: 15px;
            font-size: 1rem;
            color: var(--text-color);
        }
        
        .loading-progress {
            width: 200px;
            height: 6px;
            background-color: rgba(76, 175, 80, 0.2);
            border-radius: 3px;
            margin-top: 15px;
            overflow: hidden;
        }
        
        .loading-progress-bar {
            height: 100%;
            background-color: var(--primary-color);
            width: 0;
            border-radius: 3px;
            transition: width 0.3s;
        }
        
        .tour-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
        }
        
        .tour-overlay.active {
            display: block;
        }
        
        .tour-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 400px;
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            padding: 20px;
            z-index: 1001;
            text-align: center;
        }
        
        .tour-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .tour-content {
            color: var(--text-color);
            margin-bottom: 20px;
            font-size: 0.9rem;
            line-height: 1.6;
        }
        
        .tour-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        
        .tour-button {
            padding: 8px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
            font-size: 0.9rem;
        }
        
        .tour-button.primary {
            background-color: var(--primary-color);
            color: white;
            border: none;
        }
        
        .tour-button.primary:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
        }
        
        .tour-button.secondary {
            background-color: transparent;
            color: var(--text-color);
            border: 1px solid var(--border-color);
        }
        
        .tour-button.secondary:hover {
            background-color: var(--primary-very-light);
        }
        
        .tour-step {
            position: absolute;
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg);
            padding: 15px;
            width: 250px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            z-index: 1002;
            display: none;
        }
        
        .tour-step.active {
            display: block;
            animation: fadeIn 0.3s;
        }
        
        .tour-step-title {
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 8px;
            font-size: 0.9rem;
        }
        
        .tour-step-content {
            font-size: 0.8rem;
            color: var(--text-color);
            margin-bottom: 10px;
        }
        
        .tour-step-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .tour-step-dots {
            display: flex;
            gap: 5px;
        }
        
        .tour-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--border-color);
        }
        
        .tour-dot.active {
            background-color: var(--primary-color);
        }
        
        .tour-nav-buttons {
            display: flex;
            gap: 10px;
        }
        
        .tour-nav-button {
            background: none;
            border: none;
            color: var(--primary-color);
            cursor: pointer;
            padding: 0;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 5px;
            box-shadow: none;
        }
        
        .tour-nav-button:hover {
            text-decoration: underline;
            background: none;
            box-shadow: none;
            transform: none;
        }
        
        .tour-arrow {
            position: absolute;
            width: 15px;
            height: 15px;
            background-color: var(--card-background);
            transform: rotate(45deg);
        }
        
        .event-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        
        .event-overlay.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .event-popup {
            width: 400px;
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
            animation: popIn 0.5s;
        }
        
        .event-header {
            padding: 20px;
            background-color: var(--primary-color);
            color: white;
            text-align: center;
            position: relative;
        }
        
        .event-close {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            padding: 0;
            width: auto;
            height: auto;
            box-shadow: none;
        }
        
        .event-close:hover {
            transform: scale(1.1);
            background: none;
            box-shadow: none;
        }
        
        .event-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .event-subtitle {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        .event-icon {
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 5rem;
            opacity: 0.2;
            transform: rotate(15deg);
        }
        
        .event-body {
            padding: 20px;
        }
        
        .event-description {
            color: var(--text-color);
            margin-bottom: 20px;
            font-size: 0.9rem;
            line-height: 1.6;
        }
        
        .event-actions {
            display: flex;
            gap: 10px;
        }
        
        .event-button {
            flex: 1;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }
        
        .event-button.primary {
            background-color: var(--primary-color);
            color: white;
        }
        
        .event-button.primary:hover {
            background-color: var(--primary-dark);
            transform: translateY(-3px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
        }
        
        .event-button.secondary {
            background-color: var(--primary-very-light);
            color: var(--text-color);
            border: 1px solid var(--border-color);
        }
        
        .event-button.secondary:hover {
            background-color: var(--primary-light);
            color: white;
            border-color: var(--primary-light);
        }
        
        .notifications-panel {
            position: fixed;
            top: 70px;
            right: -350px;
            width: 320px;
            max-height: 80vh;
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg);
            box-shadow: 0 5px 15px var(--shadow-color);
            z-index: 950;
            transition: right 0.5s ease;
            overflow-y: auto;
            border: 1px solid var(--border-color);
        }
        
        .notifications-panel.active {
            right: 10px;
        }
        
        .notifications-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .notifications-title {
            font-weight: bold;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .notifications-close {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-color);
            font-size: 1.2rem;
            padding: 0;
            width: auto;
            box-shadow: none;
        }
        
        .notifications-close:hover {
            transform: scale(1.1);
            background: none;
            box-shadow: none;
        }
        
        .user-profile {
            position: fixed;
            top: 80px;
            right: 10px;
            width: 300px;
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg);
            box-shadow: 0 5px 15px var(--shadow-color);
            z-index: 950;
            display: none;
            border: 1px solid var(--border-color);
        }
        
        .user-profile.active {
            display: block;
            animation: fadeIn 0.3s;
        }
        
        .profile-header {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid var(--border-color);
        }
        
        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background-color: var(--primary-very-light);
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: var(--primary-color);
        }
        
        .profile-name {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--text-color);
            margin-bottom: 5px;
        }
        
        .profile-role {
            font-size: 0.8rem;
            color: var(--text-light);
        }
        
        .profile-stats {
            display: flex;
            justify-content: space-around;
            padding: 15px 0;
            border-bottom: 1px solid var(--border-color);
        }
        
        .profile-stat {
            text-align: center;
        }
        
        .stat-number {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .stat-label {
            font-size: 0.7rem;
            color: var(--text-light);
        }
        
        .profile-menu {
            padding: 15px;
        }
        
        .profile-menu-item {
            padding: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--text-color);
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.2s;
        }
        
        .profile-menu-item:hover {
            background-color: var(--primary-very-light);
            transform: translateX(5px);
        }
        
        .profile-menu-item i {
            width: 20px;
            color: var(--primary-color);
        }
        
        .route-info {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--card-background);
            padding: 12px 20px;
            border-radius: 25px;
            box-shadow: 0 5px 15px var(--shadow-color);
            z-index: 700;
            display: none;
            align-items: center;
            transition: all 0.3s;
            border: 1px solid var(--border-color);
        }
        
        .route-info.active {
            display: flex;
            animation: slide-up 0.5s ease-out;
        }
        
        .route-info .route-text {
            margin-right: 20px;
            color: var(--text-color);
        }
        
        /* ===== CONTROL BUTTONS & FLOATING ELEMENTS ===== */
        .dark-mode-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--card-background);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 3px 10px var(--shadow-color);
            z-index: 901;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid var(--border-color);
        }
        
        .dark-mode-toggle:hover {
            transform: scale(1.1) rotate(10deg);
        }
        
        .dark-mode-toggle i {
            font-size: 1.3rem;
            color: var(--text-color);
            transition: all 0.3s;
        }
        
        .voice-command {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--card-background);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 3px 10px var(--shadow-color);
            z-index: 901;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid var(--border-color);
        }
        
        .voice-command:hover {
            transform: scale(1.1);
            background-color: var(--primary-color);
        }
        
        .voice-command:hover i {
            color: white;
        }
        
        .voice-command i {
            font-size: 1.3rem;
            color: var(--text-color);
            transition: all 0.3s;
        }
        
        .voice-command.active {
            background-color: var(--accent-color);
            animation: pulse 1.5s infinite;
        }
        
        .voice-command.active i {
            color: white;
        }
        
        .floating-buttons {
            position: fixed;
            bottom: 80px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 900;
        }
        
        .floating-button {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--card-background);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 3px 10px var(--shadow-color);
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid var(--border-color);
            transform: translateY(100px);
            opacity: 0;
        }
        
        .floating-buttons.active .floating-button {
            transform: translateY(0);
            opacity: 1;
        }
        
        .floating-buttons.active .floating-button:nth-child(1) {
            transition-delay: 0.1s;
        }
        
        .floating-buttons.active .floating-button:nth-child(2) {
            transition-delay: 0.2s;
        }
        
        .floating-buttons.active .floating-button:nth-child(3) {
            transition-delay: 0.3s;
        }
        
        .floating-button:hover {
            transform: scale(1.1);
            background-color: var(--primary-color);
        }
        
        .floating-button:hover i {
            color: white;
        }
        
        .floating-button i {
            font-size: 1.3rem;
            color: var(--text-color);
            transition: all 0.3s;
        }
        
        .floating-toggle {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 3px 10px var(--shadow-color);
            cursor: pointer;
            transition: all 0.3s;
            color: white;
            font-size: 1.5rem;
        }
        
        .floating-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px var(--shadow-color);
        }
        
        .floating-toggle.active {
            transform: rotate(45deg);
        }
        
        /* ===== FILTER SLIDER ===== */
        .filter-slider-container {
            padding: 10px 0;
        }
        
        .slider-values {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            margin-top: 8px;
            color: var(--text-color);
        }
        
        .noUi-target {
            background: var(--primary-very-light);
            border-radius: 10px;
            border: none;
            box-shadow: none;
            height: 8px;
        }
        
        .noUi-connect {
            background: var(--primary-color);
        }
        
        .noUi-handle {
            border: none;
            background: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            width: 18px !important;
            height: 18px !important;
            border-radius: 50%;
            top: -5px !important;
            right: -9px !important;
            cursor: pointer;
        }
        
        .noUi-handle:before, .noUi-handle:after {
            display: none;
        }
        
        /* ===== NEW 3D BIN COMPONENT ===== */
        .bin3d-container {
            height: 150px;
            background-color: var(--primary-very-light);
            border-radius: var(--border-radius-lg);
            position: relative;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .bin3d {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 100px;
            transform-style: preserve-3d;
            animation: rotate3d 10s infinite linear;
        }
        
        .bin3d-part {
            position: absolute;
            background-color: var(--primary-color);
            border: 2px solid rgba(0,0,0,0.1);
        }
        
        .bin3d-front, .bin3d-back {
            width: 60px;
            height: 80px;
            top: 10px;
            left: 10px;
        }
        
        .bin3d-front {
            transform: translateZ(30px);
        }
        
        .bin3d-back {
            transform: translateZ(-30px) rotateY(180deg);
        }
        
        .bin3d-left, .bin3d-right {
            width: 60px;
            height: 80px;
            top: 10px;
            left: -20px;
        }
        
        .bin3d-left {
            transform: rotateY(-90deg);
        }
        
        .bin3d-right {
            transform: rotateY(90deg);
            left: 40px;
        }
        
        .bin3d-top, .bin3d-bottom {
            width: 60px;
            height: 60px;
            left: 10px;
        }
        
        .bin3d-top {
            transform: rotateX(90deg);
            top: -20px;
            background-color: var(--primary-dark);
        }
        
        .bin3d-bottom {
            transform: rotateX(-90deg);
            top: 70px;
        }
        
        .bin3d-lid {
            width: 70px;
            height: 10px;
            top: -5px;
            left: 5px;
            background-color: var(--primary-dark);
            transform: translateZ(0px) rotateX(0deg);
            transform-origin: bottom;
            animation: openLid 5s infinite;
        }
        
        .bin3d-fill {
            position: absolute;
            bottom: 25px;
            left: 15px;
            width: 50px;
            height: 0;
            background-color: rgba(255,255,255,0.3);
            z-index: 10;
            animation: fillBin 5s infinite;
        }
        
        /* ===== FORM LAYOUT UTILITIES ===== */
        .form-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .form-row .control-item {
            flex: 1;
            margin-bottom: 0;
        }
        
        /* ===== RESPONSIVE DESIGN ADJUSTMENTS ===== */
        @media (max-width: 1024px) {
            .sidebar {
                width: 320px;
            }
            
            .sidebar-toggle {
                right: 330px;
            }
            
            .controls {
                max-width: 260px;
            }
            
            .stats-timeline {
                height: 180px;
            }
            
            .stats.stats-6 {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .header-left {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .logo {
                margin-bottom: 8px;
            }
            
            .iot-status {
                display: none;
            }
            
            .sidebar {
                position: absolute;
                right: 0;
                height: 100%;
                width: 100%;
                max-width: 350px;
                transform: translateX(100%);
                z-index: 800;
            }
            
            .sidebar.collapsed {
                transform: translateX(100%);
            }
            
            .sidebar-toggle {
                right: 10px;
                top: 70px;
                z-index: 801;
            }
            
            .controls {
                max-width: calc(100% - 20px);
                bottom: 80px;
                left: 10px;
                top: auto;
                z-index: 750;
            }
            
            .weather-widget {
                top: 10px;
                z-index: 697;
            }
            
            .map-mode-switch {
                bottom: 150px;
                top: auto;
                z-index: 699;
            }
            
            .heatmap-toggle {
                bottom: 200px;
                top: auto;
                z-index: 698;
            }
            
            .dark-mode-toggle {
                bottom: 80px;
                z-index: 901;
            }
            
            .route-info {
                bottom: 140px;
                max-width: 90%;
                z-index: 700;
            }
            
            .legend {
                top: 70px;
                bottom: auto;
                z-index: 700;
            }
            
            .stats, .stats.stats-4, .stats.stats-6 {
                grid-template-columns: 1fr;
            }
        }
        
        /* ===== ANIMATIONS ===== */
        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        @keyframes spin {
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes popIn {
            0% { transform: scale(0.5); opacity: 0; }
            70% { transform: scale(1.05); }
            100% { transform: scale(1); opacity: 1; }
        }
        
        @keyframes slide-up {
            from { transform: translate(-50%, 50px); opacity: 0; }
            to { transform: translate(-50%, 0); opacity: 1; }
        }
        
        @keyframes progressAnimation {
            0% { background-position: 0 0; }
            100% { background-position: 15px 0; }
        }
        
        @keyframes fillBin {
            0%, 10% { height: 0; }
            50%, 90% { height: 50px; }
            100% { height: 0; }
        }
        
        @keyframes openLid {
            0%, 10%, 90%, 100% { transform: translateZ(0px) rotateX(0deg); }
            50% { transform: translateZ(0px) rotateX(-120deg); }
        }
        
        @keyframes rotate3d {
            0% { transform: translate(-50%, -50%) rotateY(0deg); }
            100% { transform: translate(-50%, -50%) rotateY(360deg); }
        }
        
        @keyframes pulse-animation {
            0% { transform: scale(0.5); opacity: 1; }
            100% { transform: scale(2); opacity: 0; }
        }
        
        /* Custom animation classes */
        .bounce-hover {
            transition: all 0.2s;
        }
        
        .bounce-hover:hover {
            transform: translateY(-5px);
        }
        
        .hover-scale {
            transition: all 0.2s;
        }
        
        .hover-scale:hover {
            transform: scale(1.05);
        }
        
        .floating-animation {
            animation: floatingBin 3s ease-in-out infinite;
        }
        
        @keyframes floatingBin {
            0% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0); }
        }
        
        /* New Enhanced Features */
        .marker-pulse {
            border-radius: 50%;
            height: 14px;
            width: 14px;
            position: absolute;
            transform: scale(1);
            transform-origin: center center;
            animation: pulse-animation 2s infinite;
        }
        
        /* Improved Bin Animation */
        .bin-animation {
            position: relative;
            width: 50px;
            height: 50px;
            margin: 0 auto 15px;
        }
        
        .bin-animation .bin {
            width: 40px;
            height: 50px;
            background-color: var(--primary-color);
            border-radius: 5px 5px 0 0;
            position: relative;
            margin: 0 auto;
            box-shadow: 0 3px 6px rgba(0,0,0,0.2);
        }
        
        .bin-animation .bin::before {
            content: '';
            position: absolute;
            width: 50px;
            height: 10px;
            background-color: var(--primary-dark);
            top: -10px;
            left: -5px;
            border-radius: 5px 5px 0 0;
        }
        
        .bin-animation .bin::after {
            content: '';
            position: absolute;
            width: 36px;
            height: 8px;
            background-color: var(--primary-light);
            bottom: 5px;
            left: 2px;
            animation: binFill 3s infinite;
            transform-origin: bottom;
        }
        
        @keyframes binFill {
            0% { height: 0; }
            50% { height: 35px; }
            100% { height: 0; }
        }
        
        .bin-animation .lid {
            width: 50px;
            height: 8px;
            background-color: var(--primary-dark);
            position: absolute;
            top: -10px;
            left: -5px;
            border-radius: 5px 5px 0 0;
            animation: lidOpen 3s infinite;
            transform-origin: center top;
            z-index: 2;
        }
        
        @keyframes lidOpen {
            0%, 30%, 70%, 100% { transform: rotate(0); }
            50% { transform: rotate(-30deg); }
        }
        
        .bin-animation .trash {
            width: 8px;
            height: 8px;
            background-color: #fff;
            border-radius: 50%;
            position: absolute;
            top: -20px;
            left: 50%;
            margin-left: -4px;
            animation: trashFall 3s infinite;
            z-index: 1;
        }
        
        @keyframes trashFall {
            0%, 30% { transform: translateY(0); opacity: 0; }
            40% { transform: translateY(0); opacity: 1; }
            50% { transform: translateY(30px); opacity: 1; }
            51% { opacity: 0; }
            100% { opacity: 0; }
        }
        
        /* Enhanced UI Components */
        .gamification-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background-color: var(--primary-color);
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            font-size: 0.7rem;
            font-weight: bold;
            position: absolute;
            top: -5px;
            right: -5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: all 0.3s;
        }
        
        .gamification-badge:hover {
            transform: scale(1.2);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        
        /* New Enhanced Analytics Components */
        .analytics-card {
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg);
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 3px 10px var(--shadow-color);
            transition: all 0.3s ease;
        }
        
        .analytics-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px var(--shadow-color);
        }
        
        .analytics-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .analytics-title {
            font-size: 1rem;
            font-weight: bold;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .analytics-icon {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: var(--primary-very-light);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-color);
        }
        
        /* New Progress Circle Component */
        .progress-circle-container {
            position: relative;
            width: 100px;
            height: 100px;
            margin: 0 auto;
        }
        
        .progress-circle {
            transform: rotate(-90deg);
            width: 100%;
            height: 100%;
        }
        
        .progress-circle-bg {
            fill: none;
            stroke: var(--primary-very-light);
            stroke-width: 8;
        }
        
        .progress-circle-value {
            fill: none;
            stroke: var(--primary-color);
            stroke-width: 8;
            stroke-linecap: round;
            transition: stroke-dasharray 1s ease;
        }
        
        .progress-circle-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-dark);
        }
        
        /* New Tip Card Component */
        .tip-card {
            background-color: var(--primary-very-light);
            border-radius: var(--border-radius-lg);
            padding: 15px;
            margin: 15px 0;
            position: relative;
            border-left: 4px solid var(--primary-color);
            transition: all 0.3s ease;
        }
        
        .tip-card:hover {
            transform: translateX(5px);
            box-shadow: 0 3px 8px var(--shadow-color);
        }
        
        .tip-card-title {
            font-weight: bold;
            color: var(--primary-dark);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .tip-card-content {
            color: var(--text-color);
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        /* Real-time Updates Banner */
        .realtime-updates {
            position: fixed;
            bottom: 80px;
            left: 10px;
            max-width: 300px;
            background-color: var(--primary-dark);
            color: white;
            padding: 10px 15px;
            border-radius: var(--border-radius-lg);
            font-size: 0.85rem;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            z-index: 900;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.5s ease;
        }
        
        .realtime-updates.active {
            transform: translateY(0);
            opacity: 1;
        }
        
        .realtime-updates-title {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .realtime-updates-content {
            margin-bottom: 10px;
        }
        
        .realtime-updates-progress {
            width: 100%;
            height: 4px;
            background-color: rgba(255,255,255,0.3);
            border-radius: 2px;
            overflow: hidden;
        }
        
        .realtime-updates-bar {
            height: 100%;
            background-color: white;
            width: 0%;
            border-radius: 2px;
            animation: updateProgress 8s linear forwards;
        }
        
        @keyframes updateProgress {
            from { width: 0%; }
            to { width: 100%; }
        }
        
        /* Leaderboard Component */
        .leaderboard {
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg);
            padding: 15px;
            margin-top: 20px;
            box-shadow: 0 3px 10px var(--shadow-color);
        }
        
        .leaderboard-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .leaderboard-title {
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-color);
        }
        
        .leaderboard-item {
            display: flex;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid var(--border-color);
            transition: all 0.2s ease;
        }
        
        .leaderboard-item:last-child {
            border-bottom: none;
        }
        
        .leaderboard-item:hover {
            background-color: var(--primary-very-light);
            transform: scale(1.02);
        }
        
        .leaderboard-position {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background-color: var(--primary-very-light);
            color: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.8rem;
            margin-right: 10px;
        }
        
        .leaderboard-item:nth-child(1) .leaderboard-position {
            background-color: gold;
            color: #333;
        }
        
        .leaderboard-item:nth-child(2) .leaderboard-position {
            background-color: silver;
            color: #333;
        }
        
        .leaderboard-item:nth-child(3) .leaderboard-position {
            background-color: #cd7f32;
            color: #333;
        }
        
        .leaderboard-user {
            flex: 1;
            font-weight: bold;
            color: var(--text-color);
        }
        
        .leaderboard-score {
            font-weight: bold;
            color: var(--primary-color);
            margin-left: 10px;
        }
        
        /* Task Card Component */
        .task-card {
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg);
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 3px 10px var(--shadow-color);
            transition: all 0.3s ease;
            border-left: 3px solid var(--primary-color);
        }
        
        .task-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px var(--shadow-color);
        }
        
        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .task-title {
            font-weight: bold;
            color: var(--text-color);
        }
        
        .task-priority {
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: bold;
        }
        
        .task-priority.high {
            background-color: var(--accent-color);
            color: white;
        }
        
        .task-priority.medium {
            background-color: var(--warning-color);
            color: white;
        }
        
        .task-priority.low {
            background-color: var(--primary-light);
            color: white;
        }
        
        .task-details {
            font-size: 0.85rem;
            color: var(--text-color);
            margin-bottom: 10px;
        }
        
        .task-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8rem;
            color: var(--text-light);
        }
        
        .task-locations {
            display: flex;
            gap: 5px;
        }
        
        .task-location {
            padding: 2px 8px;
            background-color: var(--primary-very-light);
            border-radius: 10px;
            font-size: 0.7rem;
        }
        
        /* Enhanced Feature: New Eco-tips Section */
        .eco-tips {
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg);
            padding: 15px;
            margin-top: 20px;
            box-shadow: 0 3px 10px var(--shadow-color);
            position: relative;
            overflow: hidden;
        }
        
        .eco-tips-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            color: var(--primary-dark);
            font-weight: bold;
        }
        
        .eco-tips-header i {
            font-size: 1.3rem;
            color: var(--primary-color);
        }
        
        .eco-tip {
            background-color: var(--primary-very-light);
            padding: 10px;
            border-radius: var(--border-radius-md);
            margin-bottom: 10px;
            font-size: 0.9rem;
            position: relative;
            transition: all 0.3s ease;
        }
        
        .eco-tip:hover {
            transform: translateX(5px);
        }
        
        .eco-tip:last-child {
            margin-bottom: 0;
        }
        
        .eco-tip::before {
            content: '🌱';
            margin-right: 8px;
        }
        
        /* New Achievement System */
        .achievements {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        
        .achievement {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: var(--primary-very-light);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-color);
            font-size: 1.5rem;
            position: relative;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .achievement:hover {
            transform: scale(1.1);
        }
        
        .achievement.locked {
            background-color: var(--border-color);
            color: rgba(0,0,0,0.3);
            opacity: 0.6;
        }
        
        .achievement.locked::after {
            content: '🔒';
            font-size: 1rem;
            position: absolute;
            bottom: 0;
            right: 0;
        }
        
        /* Enhanced waste reduction calculator */
        .waste-calculator {
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg);
            padding: 15px;
            margin-top: 20px;
            box-shadow: 0 3px 10px var(--shadow-color);
            transition: all 0.3s ease;
        }
        
        .waste-calculator:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px var(--shadow-color);
        }
        
        .calculator-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .calculator-title {
            font-weight: bold;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .calculator-body {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        @media (max-width: 768px) {
            .calculator-body {
                grid-template-columns: 1fr;
            }
        }
        
        .calculator-input {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .calculator-input label {
            font-size: 0.8rem;
            color: var(--text-color);
        }
        
        .calculator-result {
            background-color: var(--primary-very-light);
            border-radius: var(--border-radius-md);
            padding: 10px;
            text-align: center;
        }
        
        .result-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-dark);
            margin-bottom: 5px;
        }
        
        .result-label {
            font-size: 0.8rem;
            color: var(--text-light);
        }
        
        /* New AI Recommendation System */
        .ai-recommendations {
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg);
            padding: 15px;
            margin-top: 20px;
            box-shadow: 0 3px 10px var(--shadow-color);
            transition: all 0.3s ease;
            overflow: hidden;
            position: relative;
        }
        
        .ai-recommendations:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px var(--shadow-color);
        }
        
        .ai-recommendations::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--primary-very-light) 0%, transparent 70%);
            border-radius: 0 0 0 80px;
            opacity: 0.7;
        }
        
        .ai-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .ai-icon {
            width: 36px;
            height: 36px;
            border-radius: 18px;
            background-color: var(--primary-very-light);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-color);
            font-size: 1.2rem;
        }
        
        .ai-title {
            font-weight: bold;
            color: var(--text-color);
        }
        
        .ai-recommendation {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 10px;
            border-radius: var(--border-radius-md);
            background-color: var(--primary-very-light);
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }
        
        .ai-recommendation:hover {
            transform: translateX(5px);
            background-color: rgba(139, 195, 74, 0.2);
        }
        
        .ai-recommendation:last-child {
            margin-bottom: 0;
        }
        
        .recommendation-icon {
            color: var(--primary-color);
            font-size: 1.1rem;
            margin-top: 2px;
        }
        
        .recommendation-text {
            flex: 1;
            font-size: 0.9rem;
            color: var(--text-color);
            line-height: 1.4;
        }
        
        /* Enhanced Performance Metrics */
        .performance-metrics {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        @media (max-width: 768px) {
            .performance-metrics {
                grid-template-columns: 1fr;
            }
        }
        
        .metric-card {
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg);
            padding: 15px;
            box-shadow: 0 3px 10px var(--shadow-color);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            overflow: hidden;
        }
        
        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px var(--shadow-color);
        }
        
        .metric-icon {
            width: 40px;
            height: 40px;
            border-radius: 20px;
            background-color: var(--primary-very-light);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-color);
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        
        .metric-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary-dark);
            margin-bottom: 5px;
        }
        
        .metric-label {
            font-size: 0.8rem;
            color: var(--text-light);
            text-align: center;
        }
        
        .metric-progress {
            width: 100%;
            height: 4px;
            background-color: var(--primary-very-light);
            border-radius: 2px;
            margin-top: 10px;
            overflow: hidden;
        }
        
        .metric-bar {
            height: 100%;
            background-color: var(--primary-color);
            border-radius: 2px;
            transition: width 1s ease;
        }
        
        /* Data Analysis Section */
        .data-analysis {
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg);
            padding: 15px;
            margin-top: 20px;
            box-shadow: 0 3px 10px var(--shadow-color);
            transition: all 0.3s ease;
        }
        
        .data-analysis:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px var(--shadow-color);
        }
        
        .analysis-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .analysis-title {
            font-weight: bold;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .analysis-period {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .period-selector {
            background-color: var(--primary-very-light);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            padding: 3px 10px;
            font-size: 0.8rem;
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .period-selector:hover {
            background-color: var(--primary-light);
            color: white;
        }
        
        .data-visualization {
            height: 250px;
            margin-bottom: 15px;
            position: relative;
        }
        
        .data-insights {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }
        
        @media (max-width: 768px) {
            .data-insights {
                grid-template-columns: 1fr;
            }
        }
        
        .data-insight {
            background-color: var(--primary-very-light);
            border-radius: var(--border-radius-md);
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: all 0.3s ease;
        }
        
        .data-insight:hover {
            transform: translateY(-3px);
            box-shadow: 0 3px 8px var(--shadow-color);
        }
        
        .insight-value {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--primary-dark);
            margin-bottom: 5px;
        }
        
        .insight-label {
            font-size: 0.8rem;
            color: var(--text-light);
            text-align: center;
        }
        
        /* New Modal Component for Feedback */
        .feedback-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        
        .feedback-modal.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .feedback-content {
            width: 90%;
            max-width: 500px;
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            transform: scale(0.8);
            transition: transform 0.3s;
        }
        
        .feedback-modal.active .feedback-content {
            transform: scale(1);
        }
        
        .feedback-header {
            padding: 15px;
            background-color: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .feedback-title {
            font-weight: bold;
        }
        
        .feedback-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            padding: 0;
            width: auto;
            box-shadow: none;
        }
        
        .feedback-close:hover {
            transform: scale(1.1);
            background: none;
            box-shadow: none;
        }
        
        .feedback-body {
            padding: 15px;
        }
        
        .feedback-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .rating-stars {
            display: flex;
            gap: 10px;
            justify-content: center;
            font-size: 1.5rem;
            color: #ccc;
            margin-bottom: 10px;
        }
        
        .rating-stars i {
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .rating-stars i:hover,
        .rating-stars i.active {
            color: gold;
        }
        
        .feedback-footer {
            padding: 15px;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            border-top: 1px solid var(--border-color);
        }
        
        /* New Vehicle Tracking Feature */
        .vehicle-tracking {
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg);
            padding: 15px;
            margin-top: 20px;
            box-shadow: 0 3px 10px var(--shadow-color);
            transition: all 0.3s ease;
        }
        
        .vehicle-tracking:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px var(--shadow-color);
        }
        
        .vehicle-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .vehicle-title {
            font-weight: bold;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .vehicle-list {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 15px;
        }
        
        @media (max-width: 768px) {
            .vehicle-list {
                grid-template-columns: 1fr;
            }
        }
        
        .vehicle-card {
            background-color: var(--primary-very-light);
            border-radius: var(--border-radius-md);
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .vehicle-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 3px 8px var(--shadow-color);
        }
        
        .vehicle-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--primary-color);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .vehicle-info {
            flex: 1;
        }
        
        .vehicle-id {
            font-weight: bold;
            color: var(--text-color);
            margin-bottom: 5px;
        }
        
        .vehicle-status {
            font-size: 0.8rem;
            color: var(--text-light);
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .vehicle-status.active {
            color: var(--success-color);
        }
        
        .vehicle-status i {
            font-size: 0.7rem;
        }
        
        .vehicle-status-circle {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--success-color);
            margin-right: 5px;
        }
        
        .vehicle-status-circle.inactive {
            background-color: var(--warning-color);
        }
        
        /* Enhanced Mobile Responsiveness */
        @media (max-width: 576px) {
            .header-right {
                gap: 8px;
            }
            
            .header-button {
                padding: 0.4rem;
            }
            
            .sidebar-toggle {
                width: 30px;
                height: 30px;
            }
            
            .floating-button, 
            .floating-toggle, 
            .dark-mode-toggle, 
            .voice-command {
                width: 40px;
                height: 40px;
            }
            
            .floating-button i, 
            .floating-toggle i, 
            .dark-mode-toggle i, 
            .voice-command i {
                font-size: 1.1rem;
            }
            
            .stats-timeline,
            .bin3d-container {
                height: 120px;
            }
            
            .route-info {
                flex-direction: column;
                gap: 10px;
                align-items: flex-start;
            }
            
            .route-info .route-text {
                margin-right: 0;
            }
        }
        
        /* Dynamic Multi-Data Chart Component */
        .dynamic-chart {
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg);
            padding: 15px;
            margin-top: 20px;
            box-shadow: 0 3px 10px var(--shadow-color);
            transition: all 0.3s ease;
        }
        
        .dynamic-chart:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px var(--shadow-color);
        }
        
        .chart-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .chart-title {
            font-weight: bold;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .chart-controls {
            display: flex;
            gap: 10px;
        }
        
        .chart-control {
            background-color: var(--primary-very-light);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            padding: 3px 10px;
            font-size: 0.8rem;
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .chart-control:hover,
        .chart-control.active {
            background-color: var(--primary-light);
            color: white;
        }
        
        .chart-container {
            height: 250px;
            position: relative;
        }
        
        /* Quick Access Component */
        .quick-access {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }
        
        .quick-access-item {
            flex: 1;
            min-width: 120px;
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg);
            padding: 15px;
            box-shadow: 0 3px 10px var(--shadow-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .quick-access-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px var(--shadow-color);
        }
        
        .quick-access-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background-color: var(--primary-color);
        }
        
        .quick-access-icon {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 10px;
        }
        
        .quick-access-label {
            font-size: 0.9rem;
            font-weight: bold;
            color: var(--text-color);
        }
        
        /* Enhanced Mobile Menu for Small Screens */
        .mobile-menu {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: var(--card-background);
            border-top: 1px solid var(--border-color);
            display: none;
            z-index: 900;
            box-shadow: 0 -3px 10px var(--shadow-color);
        }
        
        .mobile-menu-items {
            display: flex;
            justify-content: space-around;
        }
        
        .mobile-menu-item {
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .mobile-menu-item:hover,
        .mobile-menu-item.active {
            color: var(--primary-color);
        }
        
        .mobile-menu-icon {
            font-size: 1.3rem;
            margin-bottom: 5px;
        }
        
        .mobile-menu-label {
            font-size: 0.7rem;
        }
        
        @media (max-width: 576px) {
            .mobile-menu {
                display: block;
            }
            
            .sidebar-toggle {
                display: none;
            }
            
            body {
                padding-bottom: 60px; /* Space for mobile menu */
            }
            
            .dark-mode-toggle,
            .voice-command {
                bottom: 70px;
            }
            
            .floating-buttons {
                bottom: 130px;
            }
        }
        
        /* New Chat Interface for Support */
        .support-chat {
            position: fixed;
            bottom: 80px;
            right: 80px;
            width: 350px;
            height: 450px;
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg) var(--border-radius-lg) 0 0;
            box-shadow: 0 0 20px var(--shadow-color);
            z-index: 900;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transform: translateY(100%);
            transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }
        
        .support-chat.active {
            transform: translateY(0);
        }
        
        .chat-header {
            background-color: var(--primary-color);
            color: white;
            padding: 10px 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .chat-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: bold;
        }
        
        .chat-controls {
            display: flex;
            gap: 10px;
        }
        
        .chat-control {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
            padding: 0;
        }
        
        .chat-control:hover {
            transform: scale(1.1);
        }
        
        .chat-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .chat-message {
            max-width: 70%;
            padding: 10px;
            border-radius: 10px;
            position: relative;
            animation: fadeIn 0.3s;
        }
        
        .chat-message.user {
            align-self: flex-end;
            background-color: var(--primary-color);
            color: white;
            border-bottom-right-radius: 0;
        }
        
        .chat-message.bot {
            align-self: flex-start;
            background-color: var(--primary-very-light);
            color: var(--text-color);
            border-bottom-left-radius: 0;
        }
        
        .chat-input {
            padding: 10px;
            border-top: 1px solid var(--border-color);
            display: flex;
            gap: 10px;
        }
        
        .chat-input input {
            flex: 1;
            padding: 8px 12px;
            border-radius: 20px;
            border: 1px solid var(--border-color);
        }
        
        .chat-input button {
            background-color: var(--primary-color);
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }
        
        .chat-input button:hover {
            background-color: var(--primary-dark);
            transform: scale(1.1);
        }
        
        .chat-toggle {
            position: fixed;
            bottom: 20px;
            right: 80px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 3px 10px var(--shadow-color);
            z-index: 901;
            transition: all 0.3s ease;
        }
        
        .chat-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px var(--shadow-color);
        }
        
        .chat-toggle i {
            font-size: 1.3rem;
        }
        
        @media (max-width: 576px) {
            .support-chat {
                right: 10px;
                left: 10px;
                width: auto;
                height: 400px;
            }
            
            .chat-toggle {
                right: 20px;
                bottom: 80px;
            }
        }
        
        /* Enhanced Animation for Page Loading */
        .page-transition {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--primary-dark);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.5s cubic-bezier(0.77, 0, 0.175, 1);
            transform-origin: bottom;
        }
        
        .page-transition.loaded {
            transform: scaleY(0);
        }
        
        .transition-logo {
            width: 80px;
            height: 80px;
            background-color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: pulseLogo 1.5s infinite;
        }
        
        .transition-logo i {
            font-size: 40px;
            color: var(--primary-color);
        }
        
        @keyframes pulseLogo {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.7); }
            70% { transform: scale(1.1); box-shadow: 0 0 0 20px rgba(255, 255, 255, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 255, 255, 0); }
        }
        
        /* New Color Themes Switcher */
        .theme-selector {
            position: fixed;
            top: 20px;
            right: -180px;
            background-color: var(--card-background);
            border-radius: var(--border-radius-lg) 0 0 var(--border-radius-lg);
            box-shadow: 0 3px 10px var(--shadow-color);
            padding: 15px;
            z-index: 902;
            transition: right 0.3s ease;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .theme-selector.active {
            right: 0;
        }
        
        .theme-toggle {
            position: absolute;
            left: -30px;
            top: 10px;
            width: 30px;
            height: 30px;
            background-color: var(--card-background);
            border-radius: 5px 0 0 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: -3px 0 5px var(--shadow-color);
            color: var(--primary-color);
        }
        
        .theme-title {
            font-size: 0.9rem;
            font-weight: bold;
            color: var(--text-color);
            margin-bottom: 5px;
        }
        
        .theme-colors {
            display: flex;
            gap: 8px;
        }
        
        .theme-color {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 2px solid transparent;
        }
        
        .theme-color:hover,
        .theme-color.active {
            transform: scale(1.2);
            border-color: white;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
        }
        
        .theme-color.green {
            background-color: #4CAF50;
        }
        
        .theme-color.blue {
            background-color: #2196F3;
        }
        
        .theme-color.purple {
            background-color: #9C27B0;
        }
        
        .theme-color.orange {
            background-color: #FF9800;
        }
        
        .theme-options {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .theme-option {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.8rem;
            color: var(--text-color);
        }
        
        .theme-option input {
            width: auto;
        }
        
        .theme-reset {
            background-color: var(--primary-very-light);
            color: var(--text-color);
            border: none;
            border-radius: 15px;
            padding: 5px 10px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .theme-reset:hover {
            background-color: var(--primary-light);
            color: white;
        }
    </style>
</head>
<body>
    <div class="page-transition">
        <div class="transition-logo">
            <i class="fas fa-recycle"></i>
        </div>
    </div>

    <div class="loading-overlay active">
        <!-- <div class="spinner-container">
            <div class="spinner"></div>
        </div> -->
        <div class="loading-text">Loading Smart Waste Management System...</div>
        <div class="loading-progress">
            <div class="loading-progress-bar" id="progress-bar"></div>
        </div>
    </div>

    <!-- <div class="tour-overlay">
        <div class="tour-modal">
            <div class="tour-title">Welcome to Smart Waste Management</div>
            <div class="tour-content">
                Would you like to take a quick tour to learn about all the amazing features of our Smart Waste Management System? We'll show you how to monitor bins, optimize routes, and analyze waste data efficiently.
            </div>
            <div class="tour-buttons">
                <button class="tour-button primary" id="start-tour">Start Tour</button>
                <button class="tour-button secondary" id="skip-tour">Skip Tour</button>
            </div>
        </div> -->
        
        <div class="tour-step" id="tour-step-1">
            <div class="tour-step-title">Interactive Map</div>
            <div class="tour-step-content">This is where you can see all waste bins across Ernakulam. Click on any bin to view details and status.</div>
            <div class="tour-step-nav">
                <div class="tour-step-dots">
                    <div class="tour-dot active"></div>
                    <div class="tour-dot"></div>
                    <div class="tour-dot"></div>
                    <div class="tour-dot"></div>
                </div>
                <div class="tour-nav-buttons">
                    <button class="tour-nav-button" id="next-step-1">Next <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>
            <div class="tour-arrow"></div>
        </div>
        
        <div class="tour-step" id="tour-step-2">
            <div class="tour-step-title">Dashboard Analytics</div>
            <div class="tour-step-content">Get real-time statistics on bin status, waste collection data, and predictive analytics.</div>
            <div class="tour-step-nav">
                <div class="tour-step-dots">
                    <div class="tour-dot"></div>
                    <div class="tour-dot active"></div>
                    <div class="tour-dot"></div>
                    <div class="tour-dot"></div>
                </div>
                <div class="tour-nav-buttons">
                    <button class="tour-nav-button" id="prev-step-2"><i class="fas fa-arrow-left"></i> Prev</button>
                    <button class="tour-nav-button" id="next-step-2">Next <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>
            <div class="tour-arrow"></div>
        </div>
        
        <div class="tour-step" id="tour-step-3">
            <div class="tour-step-title">Route Optimization</div>
            <div class="tour-step-content">Generate the most efficient routes for waste collection based on fill levels and locations.</div>
            <div class="tour-step-nav">
                <div class="tour-step-dots">
                    <div class="tour-dot"></div>
                    <div class="tour-dot"></div>
                    <div class="tour-dot active"></div>
                    <div class="tour-dot"></div>
                </div>
                <div class="tour-nav-buttons">
                    <button class="tour-nav-button" id="prev-step-3"><i class="fas fa-arrow-left"></i> Prev</button>
                    <button class="tour-nav-button" id="next-step-3">Next <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>
            <div class="tour-arrow"></div>
        </div>
        
        <div class="tour-step" id="tour-step-4">
            <div class="tour-step-title">Community Engagement</div>
            <div class="tour-step-content">Report issues, schedule collections, and participate in community recycling initiatives.</div>
            <div class="tour-step-nav">
                <div class="tour-step-dots">
                    <div class="tour-dot"></div>
                    <div class="tour-dot"></div>
                    <div class="tour-dot"></div>
                    <div class="tour-dot active"></div>
                </div>
                <div class="tour-nav-buttons">
                    <button class="tour-nav-button" id="prev-step-4"><i class="fas fa-arrow-left"></i> Prev</button>
                    <button class="tour-nav-button" id="finish-tour">Finish</button>
                </div>
            </div>
            <div class="tour-arrow"></div>
        </div>
    </div>
    
    <!-- <div class="event-overlay" id="event-popup">
        <div class="event-popup">
            <div class="event-header">
                <button class="event-close" id="event-close"><i class="fas fa-times"></i></button>
                <div class="event-title">Community Cleanup Day!</div>
                <div class="event-subtitle">Join us this Saturday at Ernakulam Beach</div>
                <div class="event-icon"><i class="fas fa-hand-holding-heart"></i></div>
            </div>
            <div class="event-body">
                <div class="event-description">
                    Be part of our monthly community cleanup initiative! This month we're focusing on Ernakulam Beach area. All equipment will be provided, just bring your enthusiasm and help us keep our beautiful city clean.
                </div>
                <div class="event-actions">
                    <div class="event-button primary" id="event-join">Count Me In!</div>
                    <div class="event-button secondary" id="event-dismiss">Remind Me Later</div>
                </div>
            </div>
        </div>
    </div> -->
    
    <div class="user-profile" id="user-profile">
        <div class="profile-header">
            <div class="profile-avatar">
                <i class="fas fa-user"></i>
            </div>
            <div class="profile-name">Admin User</div>
            <div class="profile-role">System Administrator</div>
        </div>
        <div class="profile-stats">
            <div class="profile-stat">
                <div class="stat-number">15</div>
                <div class="stat-label">Reports</div>
            </div>
            <div class="profile-stat">
                <div class="stat-number">8</div>
                <div class="stat-label">Routes</div>
            </div>
            <div class="profile-stat">
                <div class="stat-number">42</div>
                <div class="stat-label">Actions</div>
            </div>
        </div>
        <div class="profile-menu">
            <div class="profile-menu-item">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </div>
            <div class="profile-menu-item">
                <i class="fas fa-user-shield"></i>
                <span>Privacy</span>
            </div>
            <div class="profile-menu-item">
                <i class="fas fa-bell"></i>
                <span>Notifications</span>
            </div>
            <div class="profile-menu-item">
                <i class="fas fa-history"></i>
                <span>Activity Log</span>
            </div>
            <div class="profile-menu-item">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
            </div>
        </div>
    </div>
    
    <div class="notifications-panel" id="notifications-panel">
        <div class="notifications-header">
            <div class="notifications-title">
                <i class="fas fa-bell"></i>
                <span>Notifications</span>
            </div>
            <button class="notifications-close" id="close-notifications">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="notifications-body">
            <div class="notifications" id="all-notifications-panel">
                <div class="notification-item urgent animate__animated animate__fadeInRight">
                    <strong>Lulu Mall Smart Bin</strong> is now at 90% capacity.
                    <div class="time"><i class="fas fa-clock"></i> 5 minutes ago</div>
                </div>
                <div class="notification-item warning animate__animated animate__fadeInRight" style="animation-delay: 0.1s">
                    <strong>Edappally Compost Bin</strong> is now at 75% capacity.
                    <div class="time"><i class="fas fa-clock"></i> 15 minutes ago</div>
                </div>
                <div class="notification-item info animate__animated animate__fadeInRight" style="animation-delay: 0.2s">
                    <strong>Kaloor Smart Waste Station</strong> battery at 30%.
                    <div class="time"><i class="fas fa-clock"></i> 30 minutes ago</div>
                </div>
                <div class="notification-item warning animate__animated animate__fadeInRight" style="animation-delay: 0.3s">
                    <strong>High Court Smart Bin</strong> requires maintenance check.
                    <div class="time"><i class="fas fa-clock"></i> 1 hour ago</div>
                </div>
                <div class="notification-item info animate__animated animate__fadeInRight" style="animation-delay: 0.4s">
                    <strong>Marine Drive Compost Bin</strong> sensor data inconsistent.
                    <div class="time"><i class="fas fa-clock"></i> 2 hours ago</div>
                </div>
                <div class="notification-item urgent animate__animated animate__fadeInRight" style="animation-delay: 0.5s">
                    <strong>Railway Station Bin</strong> is now at 95% capacity.
                    <div class="time"><i class="fas fa-clock"></i> 3 hours ago</div>
                </div>
                <div class="notification-item info animate__animated animate__fadeInRight" style="animation-delay: 0.6s">
                    <strong>Kakkanad Smart Waste System</strong> scheduled maintenance due.
                    <div class="time"><i class="fas fa-clock"></i> 1 day ago</div>
                </div>
                <div class="notification-item success animate__animated animate__fadeInRight" style="animation-delay: 0.7s">
                    <strong>Fort Kochi Recycling Station</strong> collection completed successfully.
                    <div class="time"><i class="fas fa-clock"></i> 1 day ago</div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- <div class="feedback-modal" id="feedback-modal">
        <div class="feedback-content">
            <div class="feedback-header">
                <div class="feedback-title">Rate Your Experience</div>
                <button class="feedback-close" id="close-feedback"><i class="fas fa-times"></i></button>
            </div>
            <div class="feedback-body">
                <div class="feedback-form">
                    <div class="rating-stars" id="rating-stars">
                        <i class="fas fa-star" data-rating="1"></i>
                        <i class="fas fa-star" data-rating="2"></i>
                        <i class="fas fa-star" data-rating="3"></i>
                        <i class="fas fa-star" data-rating="4"></i>
                        <i class="fas fa-star" data-rating="5"></i>
                    </div>
                    <div class="form-row">
                        <div class="control-item">
                            <label for="feedback-name">Name</label>
                            <input type="text" id="feedback-name" placeholder="Your name">
                        </div>
                    </div>
                    <div class="control-item">
                        <label for="feedback-comment">Comments</label>
                        <textarea id="feedback-comment" rows="4" placeholder="Share your thoughts with us..."></textarea>
                    </div>
                </div>
            </div>
            <div class="feedback-footer">
                <button class="secondary" id="cancel-feedback">Cancel</button>
                <button id="submit-feedback">Submit Feedback</button>
            </div>
        </div>
    </div>
    
    <div class="support-chat" id="support-chat">
        <div class="chat-header">
            <div class="chat-title">
                <i class="fas fa-headset"></i>
                <span>Support Chat</span>
            </div>
            <div class="chat-controls">
                <button class="chat-control" id="minimize-chat"><i class="fas fa-minus"></i></button>
                <button class="chat-control" id="close-chat"><i class="fas fa-times"></i></button>
            </div>
        </div>
        <div class="chat-messages" id="chat-messages">
            <div class="chat-message bot">
                Hello! How can I assist you with waste management today?
            </div>
        </div>
        <div class="chat-input">
            <input type="text" id="chat-input-field" placeholder="Type your message...">
            <button id="send-message"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>
    
    <div class="chat-toggle" id="chat-toggle">
        <i class="fas fa-comments"></i>
    </div> -->
    
    <div class="theme-selector" id="theme-selector">
        <div class="theme-toggle" id="theme-toggle">
            <i class="fas fa-palette"></i>
        </div>
        <div class="theme-title">Color Theme</div>
        <div class="theme-colors">
            <div class="theme-color green active" data-theme="green"></div>
            <div class="theme-color blue" data-theme="blue"></div>
            <div class="theme-color purple" data-theme="purple"></div>
            <div class="theme-color orange" data-theme="orange"></div>
        </div>
        <div class="theme-title">Options</div>
        <div class="theme-options">
            <div class="theme-option">
                <input type="checkbox" id="theme-animations">
                <label for="theme-animations">Reduce animations</label>
            </div>
            <div class="theme-option">
                <input type="checkbox" id="theme-contrast">
                <label for="theme-contrast">High contrast</label>
            </div>
        </div>
        <button class="theme-reset" id="theme-reset">Reset to Default</button>
    </div>

    <header>
        <div class="header-left">
            <div class="logo">
                <i class="fas fa-recycle"></i>
            </div>
            <div>
                <h1>Ernakulam Smart Waste Management System</h1>
                <div class="subtitle">IoT-enabled real-time waste bin monitoring across Kochi/Ernakulam district</div>
            </div>
        </div>
        <div class="header-right">
            <div class="iot-status">
                <div class="status-indicator"></div>
                <span>IoT Network Active</span>
            </div>
            <div class="header-button" id="notification-button">
                <i class="fas fa-bell"></i>
                <div class="notification-badge">8</div>
            </div>
            <div class="header-button" id="profile-button">
                <i class="fas fa-user"></i>
            </div>
        </div>
    </header>
    
    <div class="map-container">
        <div id="map"></div>
        
        <button class="sidebar-toggle" id="sidebar-toggle">
            <i class="fas fa-chevron-left"></i>
        </button>
        
        <div class="sidebar" id="sidebar">
            <div class="tab-buttons">
                <button class="tab-button active" data-tab="dashboard">
                    <i class="fas fa-tachometer-alt"></i> Dashboard
                </button>
                <button class="tab-button" data-tab="alerts">
                    <i class="fas fa-exclamation-triangle"></i> Alerts
                </button>
                <button class="tab-button" data-tab="bins">
                    <i class="fas fa-trash"></i> Bins
                </button>
                <button class="tab-button" data-tab="analytics">
                    <i class="fas fa-chart-line"></i> Analytics
                </button>
            </div>
            
            <div class="tab-content active" id="dashboard-tab">
                <div class="dashboard">
                    <h2><i class="fas fa-tachometer-alt"></i> System Overview</h2>
                    
                    <div class="stats stats-4">
                        <div class="stat-card hover-scale">
                            <div class="stat-icon"><i class="fas fa-dumpster"></i></div>
                            <div class="stat-value" id="total-bins">35</div>
                            <div class="stat-label">Total Bins</div>
                        </div>
                        <div class="stat-card hover-scale">
                            <div class="stat-icon"><i class="fas fa-microchip"></i></div>
                            <div class="stat-value" id="smart-bins">18</div>
                            <div class="stat-label">Smart Bins</div>
                        </div>
                        <div class="stat-card hover-scale">
                            <div class="stat-icon"><i class="fas fa-exclamation-circle"></i></div>
                            <div class="stat-value" id="bins-need-service">7</div>
                            <div class="stat-label">Need Service</div>
                        </div>
                        <div class="stat-card hover-scale">
                            <div class="stat-icon"><i class="fas fa-weight"></i></div>
                            <div class="stat-value" id="waste-collected">1.2t</div>
                            <div class="stat-label">Waste Collected</div>
                        </div>
                    </div>
                    
                    <!-- <div class="quick-access">
                        <div class="quick-access-item">
                            <div class="quick-access-icon"><i class="fas fa-route"></i></div>
                            <div class="quick-access-label">Create Route</div>
                        </div>
                        <div class="quick-access-item">
                            <div class="quick-access-icon"><i class="fas fa-plus-circle"></i></div>
                            <div class="quick-access-label">Add Bin</div>
                        </div>
                        <div class="quick-access-item">
                            <div class="quick-access-icon"><i class="fas fa-file-export"></i></div>
                            <div class="quick-access-label">Export Data</div>
                        </div>
                        <div class="quick-access-item">
                            <div class="quick-access-icon"><i class="fas fa-calendar-check"></i></div>
                            <div class="quick-access-label">Schedule</div>
                        </div>
                    </div> -->
                    
                    <div class="prediction-panel">
                        <div class="prediction-header">
                            <div class="prediction-title">
                                <i class="fas fa-brain"></i> AI Predictions
                            </div>
                            <button class="prediction-refresh">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                        </div>
                        <div class="prediction-content">
                            <div class="prediction-item">
                                <div class="prediction-bin">Lulu Mall Smart Bin</div>
                                <div class="prediction-time">Full in ~2h</div>
                            </div>
                            <div class="prediction-item">
                                <div class="prediction-bin">Railway Station Bin</div>
                                <div class="prediction-time">Full in ~4h</div>
                            </div>
                            <div class="prediction-item">
                                <div class="prediction-bin">High Court Smart Bin</div>
                                <div class="prediction-time">Full in ~8h</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="stats-timeline">
                        <canvas id="fill-rate-chart"></canvas>
                    </div>
                    
                    <div class="alerts-title">
                        <span><i class="fas fa-bell"></i> Recent Alerts</span>
                        <div class="count" id="alerts-count">3</div>
                    </div>
                    
                    <div class="notifications">
                        <div class="notification-item urgent animate__animated animate__fadeInLeft">
                            <strong>Lulu Mall Smart Bin</strong> is now at 90% capacity.
                            <div class="time"><i class="fas fa-clock"></i> 30 minutes ago</div>
                        </div>
                        <div class="notification-item warning animate__animated animate__fadeInLeft" style="animation-delay: 0.1s">
                            <strong>Railway Station Bin</strong> is now at 95% capacity.
                            <div class="time"><i class="fas fa-clock"></i> 3 hours ago</div>
                        </div>
                        <div class="notification-item info animate__animated animate__fadeInLeft" style="animation-delay: 0.2s">
                            <strong>Kaloor Smart Waste Station</strong> battery at 30%.
                            <div class="time"><i class="fas fa-clock"></i> 30 minutes ago</div>
                        </div>
                    </div>
                    
                    <button id="optimize-route" class="bounce-hover">
                        <i class="fas fa-route"></i> Generate Optimal Collection Route
                    </button>
                    
                    <div class="community-panel">
                        <div class="community-header">
                            <div class="community-title">
                                <i class="fas fa-users"></i> Community Updates
                            </div>
                            <button class="report-btn">
                                <i class="fas fa-plus"></i> Report
                            </button>
                        </div>
                        <div class="community-reports">
                            <div class="report-item">
                                <div class="report-avatar">MJ</div>
                                <div class="report-content">
                                    <div class="report-meta">
                                        <div class="report-user">Maya J.</div>
                                        <div class="report-time">2h ago</div>
                                    </div>
                                    <div class="report-text">
                                        Overflowing bin near St. Mary's School needs immediate attention!
                                    </div>
                                    <div class="report-actions">
                                        <div class="report-action">Like</div>
                                        <div class="report-action">Reply</div>
                                    </div>
                                </div>
                            </div>
                            <div class="report-item">
                                <div class="report-avatar">AK</div>
                                <div class="report-content">
                                    <div class="report-meta">
                                        <div class="report-user">Arun K.</div>
                                        <div class="report-time">5h ago</div>
                                    </div>
                                    <div class="report-text">
                                        Thank you for the quick response to my report yesterday!
                                    </div>
                                    <div class="report-actions">
                                        <div class="report-action">Like</div>
                                        <div class="report-action">Reply</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="eco-tips">
                        <div class="eco-tips-header">
                            <i class="fas fa-leaf"></i> Eco-Tips
                        </div>
                        <div class="eco-tip">Try to reduce single-use plastics by carrying reusable bags and water bottles.</div>
                        <div class="eco-tip">Segregate your waste properly - separate biodegradable from non-biodegradable.</div>
                        <div class="eco-tip">Consider composting kitchen waste to create nutrient-rich soil for your plants.</div>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="alerts-tab">
                <div class="dashboard">
                    <h2><i class="fas fa-exclamation-triangle"></i> System Alerts</h2>
                    
                    <div class="filter-chips">
                        <div class="filter-chip active" data-filter="all">
                            <i class="fas fa-filter"></i> All
                        </div>
                        <div class="filter-chip" data-filter="capacity">
                            <i class="fas fa-fill"></i> Capacity
                        </div>
                        <div class="filter-chip" data-filter="battery">
                            <i class="fas fa-battery-half"></i> Battery
                        </div>
                        <div class="filter-chip" data-filter="maintenance">
                            <i class="fas fa-tools"></i> Maintenance
                        </div>
                    </div>
                    
                    <div class="filter-slider-container">
                        <label for="urgency-filter">Filter by Urgency Level</label>
                        <div id="urgency-slider"></div>
                        <div class="slider-values">
                            <span>Low</span>
                            <span>Medium</span>
                            <span>High</span>
                        </div>
                    </div>
                    
                    <div class="task-card">
                        <div class="task-header">
                            <div class="task-title">Critical Bin Collection</div>
                            <div class="task-priority high">High Priority</div>
                        </div>
                        <div class="task-details">
                            Schedule immediate collection for bins that are over 90% full. Currently, there are 2 bins that need urgent service.
                        </div>
                        <div class="task-meta">
                            <div class="task-due">Due: Today</div>
                            <div class="task-locations">
                                <div class="task-location">Lulu Mall</div>
                                <div class="task-location">Railway Station</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="notifications" id="all-notifications">
                        <div class="notification-item urgent animate__animated animate__fadeInDown">
                            <strong>Lulu Mall Smart Bin</strong> is now at 90% capacity.
                            <div class="time"><i class="fas fa-clock"></i> 5 minutes ago</div>
                        </div>
                        <div class="notification-item warning animate__animated animate__fadeInDown" style="animation-delay: 0.1s">
                            <strong>Edappally Compost Bin</strong> is now at 75% capacity.
                            <div class="time"><i class="fas fa-clock"></i> 15 minutes ago</div>
                        </div>
                        <div class="notification-item info animate__animated animate__fadeInDown" style="animation-delay: 0.2s">
                            <strong>Kaloor Smart Waste Station</strong> battery at 30%.
                            <div class="time"><i class="fas fa-clock"></i> 30 minutes ago</div>
                        </div>
                        <div class="notification-item warning animate__animated animate__fadeInDown" style="animation-delay: 0.3s">
                            <strong>High Court Smart Bin</strong> requires maintenance check.
                            <div class="time"><i class="fas fa-clock"></i> 1 hour ago</div>
                        </div>
                        <div class="notification-item info animate__animated animate__fadeInDown" style="animation-delay: 0.4s">
                            <strong>Marine Drive Compost Bin</strong> sensor data inconsistent.
                            <div class="time"><i class="fas fa-clock"></i> 2 hours ago</div>
                        </div>
                        <div class="notification-item urgent animate__animated animate__fadeInDown" style="animation-delay: 0.5s">
                            <strong>Railway Station Bin</strong> is now at 95% capacity.
                            <div class="time"><i class="fas fa-clock"></i> 3 hours ago</div>
                        </div>
                        <div class="notification-item info animate__animated animate__fadeInDown" style="animation-delay: 0.6s">
                            <strong>Kakkanad Smart Waste System</strong> scheduled maintenance due.
                            <div class="time"><i class="fas fa-clock"></i> 1 day ago</div>
                        </div>
                        <div class="notification-item success animate__animated animate__fadeInDown" style="animation-delay: 0.7s">
                            <strong>Bin Maintenance System</strong> completed daily diagnostics check.
                            <div class="time"><i class="fas fa-clock"></i> 6 hours ago</div>
                        </div>
                    </div>
                    
                    <button id="clear-all-alerts" class="bounce-hover">
                        <i class="fas fa-check-double"></i> Mark All as Read
                    </button>
                    
                    <div class="vehicle-tracking">
                        <div class="vehicle-header">
                            <div class="vehicle-title">
                                <i class="fas fa-truck"></i> Collection Vehicles
                            </div>
                        </div>
                        <div class="vehicle-list">
                            <div class="vehicle-card">
                                <div class="vehicle-icon">
                                    <i class="fas fa-truck"></i>
                                </div>
                                <div class="vehicle-info">
                                    <div class="vehicle-id">WM-001</div>
                                    <div class="vehicle-status active">
                                        <div class="vehicle-status-circle"></div>
                                        Active - North Route
                                    </div>
                                </div>
                            </div>
                            <div class="vehicle-card">
                                <div class="vehicle-icon">
                                    <i class="fas fa-truck"></i>
                                </div>
                                <div class="vehicle-info">
                                    <div class="vehicle-id">WM-002</div>
                                    <div class="vehicle-status">
                                        <div class="vehicle-status-circle inactive"></div>
                                        Maintenance
                                    </div>
                                </div>
                            </div>
                            <div class="vehicle-card">
                                <div class="vehicle-icon">
                                    <i class="fas fa-truck"></i>
                                </div>
                                <div class="vehicle-info">
                                    <div class="vehicle-id">WM-003</div>
                                    <div class="vehicle-status active">
                                        <div class="vehicle-status-circle"></div>
                                        Active - South Route
                                    </div>
                                </div>
                            </div>
                            <div class="vehicle-card">
                                <div class="vehicle-icon">
                                    <i class="fas fa-truck"></i>
                                </div>
                                <div class="vehicle-info">
                                    <div class="vehicle-id">WM-004</div>
                                    <div class="vehicle-status active">
                                        <div class="vehicle-status-circle"></div>
                                        Active - Central Route
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="bins-tab">
                <div class="dashboard">
                    <h2><i class="fas fa-trash"></i> Waste Bins</h2>
                    
                    <div class="filter-chips">
                        <div class="filter-chip active" data-type="all">
                            <i class="fas fa-filter"></i> All Types
                        </div>
                        <div class="filter-chip" data-type="general">
                            <i class="fas fa-trash"></i> General
                        </div>
                        <div class="filter-chip" data-type="recyclable">
                            <i class="fas fa-recycle"></i> Recyclable
                        </div>
                        <div class="filter-chip" data-type="organic">
                            <i class="fas fa-leaf"></i> Organic
                        </div>
                        <div class="filter-chip" data-type="smart">
                            <i class="fas fa-microchip"></i> Smart
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="control-item">
                            <label for="bin-search">Search Bins</label>
                            <input type="text" id="bin-search" placeholder="Enter bin name or location...">
                        </div>
                        <div class="control-item">
                            <label for="bin-sort">Sort By</label>
                            <select id="bin-sort">
                                <option value="name">Name</option>
                                <option value="fill-high">Fill Level (High-Low)</option>
                                <option value="fill-low">Fill Level (Low-High)</option>
                                <option value="recent">Recently Updated</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="bin3d-container">
                        <div class="bin3d">
                            <div class="bin3d-part bin3d-front"></div>
                            <div class="bin3d-part bin3d-back"></div>
                            <div class="bin3d-part bin3d-left"></div>
                            <div class="bin3d-part bin3d-right"></div>
                            <div class="bin3d-part bin3d-top"></div>
                            <div class="bin3d-part bin3d-bottom"></div>
                            <div class="bin3d-part bin3d-lid"></div>
                            <div class="bin3d-fill"></div>
                        </div>
                    </div>
                    
                    <div class="bin-list" id="bin-list">
                        <!-- Bin list will be populated dynamically using JavaScript -->
                    </div>
                    
                    <div class="performance-metrics">
                        <div class="metric-card">
                            <div class="metric-icon">
                                <i class="fas fa-history"></i>
                            </div>
                            <div class="metric-value">4.2h</div>
                            <div class="metric-label">Average Collection Time</div>
                            <div class="metric-progress">
                                <div class="metric-bar" style="width: 70%;"></div>
                            </div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-icon">
                                <i class="fas fa-route"></i>
                            </div>
                            <div class="metric-value">98%</div>
                            <div class="metric-label">Route Efficiency</div>
                            <div class="metric-progress">
                                <div class="metric-bar" style="width: 98%;"></div>
                            </div>
                        </div>
                    </div>
                    
                    <button id="add-new-bin" class="bounce-hover" style="margin-top: 15px;">
                        <i class="fas fa-plus"></i> Register New Bin
                    </button>
                    
                    <div class="achievements">
                        <div class="achievement" title="Efficiency Master">
                            <i class="fas fa-tachometer-alt"></i>
                        </div>
                        <div class="achievement" title="Waste Reducer">
                            <i class="fas fa-trash-alt"></i>
                        </div>
                        <div class="achievement" title="Route Optimizer">
                            <i class="fas fa-map-marked-alt"></i>
                        </div>
                        <div class="achievement locked" title="Community Hero">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="achievement locked" title="Green Champion">
                            <i class="fas fa-seedling"></i>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="analytics-tab">
                <div class="dashboard">
                    <h2><i class="fas fa-chart-line"></i> Waste Analytics</h2>
                    
                    <div class="dynamic-chart">
                        <div class="chart-header">
                            <div class="chart-title">
                                <i class="fas fa-chart-area"></i>
                                Waste Collection Trends
                            </div>
                            <div class="chart-controls">
                                <div class="chart-control active" data-period="week">Week</div>
                                <div class="chart-control" data-period="month">Month</div>
                                <div class="chart-control" data-period="year">Year</div>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="waste-trend-chart"></canvas>
                        </div>
                    </div>
                    
                    <div class="data-analysis">
                        <div class="analysis-header">
                            <div class="analysis-title">
                                <i class="fas fa-microscope"></i>
                                Waste Composition Analysis
                            </div>
                            <div class="analysis-period">
                                <div class="period-selector">Last 30 Days</div>
                            </div>
                        </div>
                        <div class="data-visualization">
                            <canvas id="composition-chart"></canvas>
                        </div>
                        <div class="data-insights">
                            <div class="data-insight">
                                <div class="insight-value">32%</div>
                                <div class="insight-label">Recycling Rate</div>
                            </div>
                            <div class="data-insight">
                                <div class="insight-value">18%</div>
                                <div class="insight-label">Waste Reduction</div>
                            </div>
                            <div class="data-insight">
                                <div class="insight-value">28%</div>
                                <div class="insight-label">Organic Processing</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="stats stats-6">
                        <div class="stat-card hover-scale">
                            <div class="stat-icon"><i class="fas fa-percentage"></i></div>
                            <div class="stat-value">32%</div>
                            <div class="stat-label">Recycling Rate</div>
                        </div>
                        <div class="stat-card hover-scale">
                            <div class="stat-icon"><i class="fas fa-trash-restore"></i></div>
                            <div class="stat-value">18%</div>
                            <div class="stat-label">Waste Reduction</div>
                        </div>
                        <div class="stat-card hover-scale">
                            <div class="stat-icon"><i class="fas fa-leaf"></i></div>
                            <div class="stat-value">28%</div>
                            <div class="stat-label">Organic Waste</div>
                        </div>
                        <div class="stat-card hover-scale">
                            <div class="stat-icon"><i class="fas fa-smog"></i></div>
                            <div class="stat-value">42%</div>
                            <div class="stat-label">Landfill Diversion</div>
                        </div>
                        <div class="stat-card hover-scale">
                            <div class="stat-icon"><i class="fas fa-car-battery"></i></div>
                            <div class="stat-value">8%</div>
                            <div class="stat-label">Hazardous Waste</div>
                        </div>
                        <div class="stat-card hover-scale">
                            <div class="stat-icon"><i class="fas fa-bolt"></i></div>
                            <div class="stat-value">15kW</div>
                            <div class="stat-label">Energy Produced</div>
                        </div>
                    </div>
                    
                    <div class="waste-calculator">
                        <div class="calculator-header">
                            <div class="calculator-title">
                                <i class="fas fa-calculator"></i>
                                Waste Reduction Calculator
                            </div>
                        </div>
                        <div class="calculator-body">
                            <div class="calculator-input">
                                <label for="current-waste">Current Waste (kg/week)</label>
                                <input type="number" id="current-waste" value="100">
                            </div>
                            <div class="calculator-input">
                                <label for="reduction-target">Reduction Target (%)</label>
                                <input type="number" id="reduction-target" value="20">
                            </div>
                            <div class="calculator-input">
                                <label for="timeframe">Timeframe (weeks)</label>
                                <input type="number" id="timeframe" value="12">
                            </div>
                            <div class="calculator-result">
                                <div class="result-value" id="reduction-result">20 kg</div>
                                <div class="result-label">Weekly Reduction Needed</div>
                            </div>
                        </div>
                        <button id="calculate-reduction" class="bounce-hover">Calculate Impact</button>
                    </div>
                    
                    <div class="timeline">
                        <div class="timeline-item">
                            <div class="timeline-dot"></div>
                            <div class="timeline-content">
                                <div class="timeline-title">Waste Collection System Upgrade</div>
                                <div class="timeline-date">April 7, 2025</div>
                                <div class="timeline-text">Upgraded 5 bins to smart IoT-enabled systems in Edappally area.</div>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot"></div>
                            <div class="timeline-content">
                                <div class="timeline-title">Route Optimization Implemented</div>
                                <div class="timeline-date">April 3, 2025</div>
                                <div class="timeline-text">New AI-based route optimization reduced collection time by 23%.</div>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot"></div>
                            <div class="timeline-content">
                                <div class="timeline-title">Community Cleanup Drive</div>
                                <div class="timeline-date">March 28, 2025</div>
                                <div class="timeline-text">Collected 500kg of waste from Ernakulam Beach with community volunteers.</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="ai-recommendations">
                        <div class="ai-header">
                            <div class="ai-icon">
                                <i class="fas fa-robot"></i>
                            </div>
                            <div class="ai-title">Smart Recommendations</div>
                        </div>
                        <div class="ai-recommendation">
                            <div class="recommendation-icon"><i class="fas fa-lightbulb"></i></div>
                            <div class="recommendation-text">Increase collection frequency in the Railway Station area during rush hours to avoid overflow.</div>
                        </div>
                        <div class="ai-recommendation">
                            <div class="recommendation-icon"><i class="fas fa-battery-three-quarters"></i></div>
                            <div class="recommendation-text">Consider solar panel upgrades for bins in the Marine Drive area to improve battery performance.</div>
                        </div>
                        <div class="ai-recommendation">
                            <div class="recommendation-icon"><i class="fas fa-chart-line"></i></div>
                            <div class="recommendation-text">Based on historical data, expect a 15% increase in waste volume during the upcoming festival season.</div>
                        </div>
                    </div>
                    
                    <!-- <button id="export-analytics" class="bounce-hover" style="margin-top: 15px;">
                        <i class="fas fa-file-export"></i> Export Analytics Report
                    </button> -->
                    
                    <div class="leaderboard">
                        <div class="leaderboard-header">
                            <div class="leaderboard-title">
                                <i class="fas fa-trophy"></i> Waste Reduction Leaderboard
                            </div>
                        </div>
                        <div class="leaderboard-item">
                            <div class="leaderboard-position">1</div>
                            <div class="leaderboard-user">Edappally Zone</div>
                            <div class="leaderboard-score">28%</div>
                        </div>
                        <div class="leaderboard-item">
                            <div class="leaderboard-position">2</div>
                            <div class="leaderboard-user">Fort Kochi Zone</div>
                            <div class="leaderboard-score">24%</div>
                        </div>
                        <div class="leaderboard-item">
                            <div class="leaderboard-position">3</div>
                            <div class="leaderboard-user">Kaloor Zone</div>
                            <div class="leaderboard-score">20%</div>
                        </div>
                        <div class="leaderboard-item">
                            <div class="leaderboard-position">4</div>
                            <div class="leaderboard-user">Marine Drive Zone</div>
                            <div class="leaderboard-score">18%</div>
                        </div>
                        <div class="leaderboard-item">
                            <div class="leaderboard-position">5</div>
                            <div class="leaderboard-user">Thoppumpady Zone</div>
                            <div class="leaderboard-score">15%</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="controls">
            <div class="control-item">
                <label for="map-type">Map Type</label>
                <select id="map-type">
                    <option value="street">Street View</option>
                    <option value="satellite">Satellite</option>
                    <option value="terrain">Terrain</option>
                </select>
            </div>
            
            <div class="control-item">
                <button id="zoom-to-fit" class="bounce-hover">
                    <i class="fas fa-search"></i> Zoom to Ernakulam
                </button>
            </div>
            
            <div class="control-item">
                <label>Map Layers</label>
                <div style="display: flex; gap: 8px; margin-top: 5px;">
                    <button id="show-waste-bins" style="flex: 1; font-size: 0.8rem;">
                        <i class="fas fa-eye"></i> Show Bins
                    </button>
                    <button id="hide-waste-bins" class="secondary" style="flex: 1; font-size: 0.8rem;">
                        <i class="fas fa-eye-slash"></i> Hide Bins
                    </button>
                </div>
            </div>
            
            <div class="control-item">
                <label for="bin-type">Filter Bin Type</label>
                <select id="bin-type">
                    <option value="all">All Bins</option>
                    <option value="general">General Waste</option>
                    <option value="recyclable">Recyclables</option>
                    <option value="organic">Organic Waste</option>
                    <option value="smart">Smart Bins</option>
                </select>
            </div>
            
            <div class="control-item">
                <label for="search-place">Search Places</label>
                <input type="text" id="search-place" placeholder="Enter a location...">
            </div>
            
            <div class="places-list" id="popular-places">
                <div class="place-item" data-lat="9.9816" data-lng="76.2999">
                    <i class="fas fa-map-marker-alt"></i> Fort Kochi
                </div>
                <div class="place-item" data-lat="10.0284" data-lng="76.3122">
                    <i class="fas fa-train"></i> Ernakulam Junction
                </div>
                <div class="place-item" data-lat="9.9312" data-lng="76.2673">
                    <i class="fas fa-anchor"></i> Willingdon Island
                </div>
                <div class="place-item" data-lat="10.0159" data-lng="76.3419">
                    <i class="fas fa-shopping-cart"></i> Lulu Mall
                </div>
                <div class="place-item" data-lat="9.9656" data-lng="76.2539">
                    <i class="fas fa-monument"></i> Mattancherry Palace
                </div>
                <div class="place-item" data-lat="10.0464" data-lng="76.3388">
                    <i class="fas fa-city"></i> Kaloor
                </div>
                <div class="place-item" data-lat="10.0261" data-lng="76.3125">
                    <i class="fas fa-water"></i> Marine Drive
                </div>
            </div>
        </div>
        
        <!-- <div class="map-mode-switch">
            <div class="map-mode-option active" data-mode="normal">
                <i class="fas fa-map"></i> Normal
            </div>
            <div class="map-mode-option" data-mode="status">
                <i class="fas fa-fill-drip"></i> Status
            </div>
        </div>
        
        <div class="heatmap-toggle" data-active="false">
            <i class="fas fa-fire"></i> Density Heatmap
        </div> -->
        
        <div class="weather-widget">
            <div class="weather-header">
                <div class="weather-icon">
                    <i class="fas fa-sun"></i>
                </div>
                <div class="weather-temp">32°C</div>
            </div>
            <div class="weather-desc">Sunny, Ernakulam</div>
            <div class="weather-details">
                <div>
                    <i class="fas fa-tint"></i>
                    <span>65%</span>
                </div>
                <div>
                    <i class="fas fa-wind"></i>
                    <span>12 km/h</span>
                </div>
                <div>
                    <i class="fas fa-cloud-rain"></i>
                    <span>5%</span>
                </div>
            </div>
        </div>
    </div>
    
    <div class="route-info" id="route-info">
        <div class="route-text">
            <strong>Optimal collection route:</strong> 7 bins, 12.3 km
        </div>
        <button id="clear-route">
            <i class="fas fa-times"></i> Clear Route
        </button>
    </div>
    
    <div class="realtime-updates" id="realtime-updates">
        <div class="realtime-updates-title">
            <i class="fas fa-bell"></i> Real-time Update
        </div>
        <div class="realtime-updates-content" id="update-content">
            New bin added at Kakkanad Technology Hub.
        </div>
        <div class="realtime-updates-progress">
            <div class="realtime-updates-bar"></div>
        </div>
    </div>
    
    <div class="mobile-menu">
        <div class="mobile-menu-items">
            <div class="mobile-menu-item active">
                <div class="mobile-menu-icon"><i class="fas fa-map-marked-alt"></i></div>
                <div class="mobile-menu-label">Map</div>
            </div>
            <div class="mobile-menu-item">
                <div class="mobile-menu-icon"><i class="fas fa-tachometer-alt"></i></div>
                <div class="mobile-menu-label">Dashboard</div>
            </div>
            <div class="mobile-menu-item">
                <div class="mobile-menu-icon"><i class="fas fa-trash"></i></div>
                <div class="mobile-menu-label">Bins</div>
            </div>
            <div class="mobile-menu-item">
                <div class="mobile-menu-icon"><i class="fas fa-chart-line"></i></div>
                <div class="mobile-menu-label">Analytics</div>
            </div>
            <div class="mobile-menu-item">
                <div class="mobile-menu-icon"><i class="fas fa-cog"></i></div>
                <div class="mobile-menu-label">Settings</div>
            </div>
        </div>
    </div>
    
    <div class="dark-mode-toggle" id="dark-mode-toggle">
        <i class="fas fa-moon"></i>
    </div>
    
    <!-- <div class="voice-command" id="voice-command">
        <i class="fas fa-microphone"></i>
    </div> -->
    
    <!-- <div class="floating-buttons">
        <div class="floating-button" id="reports-button">
            <i class="fas fa-exclamation-circle"></i>
        </div>
        <div class="floating-button" id="refresh-button">
            <i class="fas fa-sync-alt"></i>
        </div>
        <div class="floating-button" id="help-button">
            <i class="fas fa-question"></i>
        </div>
        <div class="floating-toggle" id="floating-toggle">
            <i class="fas fa-plus"></i>
        </div>
    </div> -->
    
    <!-- <footer>
        Map data © OpenStreetMap contributors | Ernakulam Smart Waste Management System 2025
    </footer> -->
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.3/leaflet.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.6.1/nouislider.min.js"></script>
    <script>
        // Page loading transition
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                document.querySelector('.page-transition').classList.add('loaded');
            }, 1000);
        });

        // Helper function for animations
        function animateElement(element, animation, prefix = 'animate__') {
            return new Promise((resolve) => {
                const animationName = `${prefix}${animation}`;
                element.classList.add(`${prefix}animated`, animationName);
                
                function handleAnimationEnd(event) {
                    event.stopPropagation();
                    element.classList.remove(`${prefix}animated`, animationName);
                    resolve('Animation ended');
                }
                
                element.addEventListener('animationend', handleAnimationEnd, {once: true});
            });
        }
        
        // Show loading overlay with progress
        const loadingOverlay = document.querySelector('.loading-overlay');
        const progressBar = document.getElementById('progress-bar');
        let progress = 0;
        
        function updateProgress() {
            progress += Math.random() * 10;
            if (progress > 100) progress = 100;
            progressBar.style.width = `${progress}%`;
            
            if (progress < 100) {
                setTimeout(updateProgress, 200);
            } else {
                setTimeout(() => {
                    loadingOverlay.classList.remove('active');
                    
                    // Show tour overlay after loading
                    setTimeout(() => {
                        document.querySelector('.tour-overlay').classList.add('active');
                    }, 1000);
                }, 500);
            }
        }
        
        updateProgress();
        
        // Initialize the map centered on Ernakulam
        const map = L.map('map', {
            zoomControl: false
        }).setView([9.9816, 76.2999], 12);
        
        // Custom zoom control position
        L.control.zoom({
            position: 'bottomright'
        }).addTo(map);
        
        // OpenStreetMap tile layer (default)
        const osmLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
            maxZoom: 19
        }).addTo(map);
        
        // Satellite view (Esri WorldImagery)
        const satelliteLayer = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
            attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community',
            maxZoom: 19
        });
        
        // Terrain view (OpenTopoMap)
        const terrainLayer = L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
            attribution: 'Map data: &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, <a href="http://viewfinderpanoramas.org">SRTM</a> | Map style: &copy; <a href="https://opentopomap.org">OpenTopoMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)',
            maxZoom: 17
        });
        
        // Define Ernakulam district boundaries (approximation)
        const ernakulamBounds = L.latLngBounds(
            [9.8, 76.2], // Southwest
            [10.2, 76.8]  // Northeast
        );
        
        // Sidebar toggle functionality
        const sidebar = document.getElementById('sidebar');
        const sidebarToggle = document.getElementById('sidebar-toggle');
        
        sidebarToggle.addEventListener('click', function() {
            sidebar.classList.toggle('collapsed');
            const icon = sidebarToggle.querySelector('i');
            if (sidebar.classList.contains('collapsed')) {
                icon.classList.remove('fa-chevron-left');
                icon.classList.add('fa-chevron-right');
            } else {
                icon.classList.remove('fa-chevron-right');
                icon.classList.add('fa-chevron-left');
            }
        });
        
        // Tab functionality
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');
        
        tabButtons.forEach(button => {
            button.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                
                // Remove active class from all buttons and tabs
                tabButtons.forEach(btn => btn.classList.remove('active'));
                tabContents.forEach(tab => tab.classList.remove('active'));
                
                // Add active class to current button and tab
                this.classList.add('active');
                document.getElementById(`${tabId}-tab`).classList.add('active');
            });
        });
        
        // Map type selector
        document.getElementById('map-type').addEventListener('change', function(e) {
            const mapType = e.target.value;
            
            // Remove all layers
            map.removeLayer(osmLayer);
            map.removeLayer(satelliteLayer);
            map.removeLayer(terrainLayer);
            
            // Add selected layer
            if (mapType === 'satellite') {
                satelliteLayer.addTo(map);
            } else if (mapType === 'terrain') {
                terrainLayer.addTo(map);
            } else {
                osmLayer.addTo(map);
            }
        });
        
        // Map mode switch
        document.querySelectorAll('.map-mode-option').forEach(option => {
            option.addEventListener('click', function() {
                // Remove active class from all options
                document.querySelectorAll('.map-mode-option').forEach(opt => opt.classList.remove('active'));
                
                // Add active class to clicked option
                this.classList.add('active');
                
                // Apply map mode
                const mode = this.getAttribute('data-mode');
                applyMapMode(mode);
            });
        });
        
        function applyMapMode(mode) {
            if (mode === 'normal') {
                // Reset bin icons to normal
                updateBinIcons('normal');
            } else if (mode === 'status') {
                // Update bin icons to show status
                updateBinIcons('status');
            }
        }
        
        function updateBinIcons(mode) {
            // Clear existing bin markers
            wasteBinLayerGroup.clearLayers();
            
            // Add bins with updated icons
            wasteBins.forEach(bin => {
                if (document.getElementById('bin-type').value === 'all' || 
                    document.getElementById('bin-type').value === bin.type) {
                    
                    let icon;
                    if (mode === 'normal') {
                        icon = createBinIcon(bin);
                    } else {
                        icon = createStatusIcon(bin);
                    }
                    
                    const marker = L.marker(bin.position, {icon: icon})
                        .bindPopup(createBinPopup(bin));
                    
                    wasteBinLayerGroup.addLayer(marker);
                }
            });
        }
        
        function createStatusIcon(bin) {
            const fillLevel = parseInt(bin.status);
            let color;
            
            if (fillLevel >= 90) {
                color = '#FF5722';
            } else if (fillLevel >= 70) {
                color = '#FFA000';
            } else {
                color = '#8BC34A';
            }
            
            let pulseEffect = '';
            if (fillLevel >= 90) {
                pulseEffect = `<div class="marker-pulse" style="background-color: ${color};"></div>`;
            }
            
            return L.divIcon({
                html: `${pulseEffect}<div style="background-color: ${color}; width: 18px; height: 18px; border-radius: 50%; border: 2px solid white; display: flex; align-items: center; justify-content: center; font-size: 10px; color: white; font-weight: bold;">${fillLevel}%</div>`,
                className: 'bin-marker',
                iconSize: [22, 22]
            });
        }
        
        // Heatmap toggle
        const heatmapToggle = document.querySelector('.heatmap-toggle');
        let heatmapActive = false;
        let heatmapLayer;
        
        heatmapToggle.addEventListener('click', function() {
            heatmapActive = !heatmapActive;
            
            if (heatmapActive) {
                this.classList.add('active');
                
                // Create heatmap data points based on bin fill levels
                const heatData = wasteBins.map(bin => {
                    const fillLevel = parseInt(bin.status);
                    const intensity = fillLevel / 100;
                    return [bin.position[0], bin.position[1], intensity];
                });
                
                // Create and add heatmap layer
                heatmapLayer = L.heatLayer(heatData, {
                    radius: 25,
                    blur: 15,
                    maxZoom: 17,
                    gradient: {0.4: 'blue', 0.6: 'lime', 0.8: 'yellow', 1: 'red'}
                }).addTo(map);
            } else {
                this.classList.remove('active');
                
                // Remove heatmap layer
                if (heatmapLayer) {
                    map.removeLayer(heatmapLayer);
                }
            }
        });
        
        // Zoom to fit Ernakulam
        document.getElementById('zoom-to-fit').addEventListener('click', function() {
            map.fitBounds(ernakulamBounds);
            animateElement(this, 'bounce');
        });
        
        // Place marker
        function placeMarker(lat, lng, placeName) {
            // Clear existing place markers
            map.eachLayer(function(layer) {
                if (layer instanceof L.Marker && layer.options.icon && layer.options.icon.options.className === 'place-marker') {
                    map.removeLayer(layer);
                }
            });
            
            // Add new marker
            const placeIcon = L.divIcon({
                html: '<i class="fas fa-map-marker-alt" style="color: #FF5722; font-size: 24px; text-shadow: 0 2px 5px rgba(0,0,0,0.3);"></i>',
                className: 'place-marker',
                iconSize: [24, 24],
                iconAnchor: [12, 24],
                popupAnchor: [0, -24]
            });
            
            const marker = L.marker([lat, lng], {icon: placeIcon}).addTo(map);
            if (placeName) {
                const popup = L.popup({
                    className: 'custom-popup',
                    closeButton: false,
                    offset: [0, -20]
                })
                .setContent(`<div style="font-weight: bold; color: #FF5722; text-align: center;">${placeName}</div>`);
                
                marker.bindPopup(popup).openPopup();
            }
            
            // Center map on marker with smooth animation
            map.flyTo([lat, lng], 15, {
                duration: 1.5,
                easeLinearity: 0.5
            });
        }
        
        // Popular places click handler
        document.querySelectorAll('.place-item').forEach(function(item) {
            item.addEventListener('click', function() {
                const lat = parseFloat(this.getAttribute('data-lat'));
                const lng = parseFloat(this.getAttribute('data-lng'));
                const placeName = this.textContent.trim();
                
                placeMarker(lat, lng, placeName);
                animateElement(this, 'pulse');
            });
        });
        
        // Simple search implementation (using the places we've already defined)
        document.getElementById('search-place').addEventListener('keyup', function(e) {
            if (e.key === 'Enter') {
                const searchTerm = this.value.toLowerCase();
                const placeItems = document.querySelectorAll('.place-item');
                
                for (let item of placeItems) {
                    if (item.textContent.toLowerCase().includes(searchTerm)) {
                        const lat = parseFloat(item.getAttribute('data-lat'));
                        const lng = parseFloat(item.getAttribute('data-lng'));
                        const placeName = item.textContent.trim();
                        
                        placeMarker(lat, lng, placeName);
                        animateElement(item, 'pulse');
                        break;
                    }
                }
            }
        });
        
        // Highlight Ernakulam district (approximate)
        L.rectangle(ernakulamBounds, {
            color: "#4CAF50",
            weight: 2,
            fill: true,
            fillColor: "#4CAF50",
            fillOpacity: 0.05,
            dashArray: '5, 10'
        }).addTo(map);
        
        // Add a marker for Ernakulam city center
        L.marker([9.9816, 76.2999], {
            icon: L.divIcon({
                html: '<i class="fas fa-city" style="color: #4CAF50; font-size: 24px; text-shadow: 0 2px 5px rgba(0,0,0,0.3);"></i>',
                className: 'city-marker',
                iconSize: [24, 24],
                iconAnchor: [12, 12],
                popupAnchor: [0, -12]
            })
        })
        .addTo(map)
        .bindPopup("<b>Ernakulam (Kochi)</b><br>Kerala, India");
        
        // Optimized and expanded waste bin data with types, features and IoT functionality
        const wasteBins = [
            // Original 15 bins with updated data
            {
                id: 1,
                position: [9.9720, 76.2860],
                type: "general",
                name: "MG Road Community Bin",
                capacity: "500L",
                status: "75%",
                lastEmptied: "2025-03-16",
                features: ["Regular collection", "Public area"],
                iot: false
            },
            {
                id: 2,
                position: [10.0159, 76.3419],
                type: "smart",
                name: "Lulu Mall Smart Bin",
                capacity: "800L",
                status: "90%",
                lastEmptied: "2025-03-17",
                features: ["Fill level sensor", "Compactor", "Solar powered", "Real-time monitoring"],
                iot: true,
                battery: "85%",
                temperature: "32°C",
                humidity: "65%",
                alertStatus: "critical"
            },
            {
                id: 3,
                position: [9.9813, 76.2990],
                type: "recyclable",
                name: "Fort Kochi Recycling Station",
                capacity: "600L",
                status: "30%",
                lastEmptied: "2025-03-17",
                features: ["Segregated compartments", "Tourist area"],
                iot: false
            },
            {
                id: 4,
                position: [10.0261, 76.3125],
                type: "organic",
                name: "Marine Drive Compost Bin",
                capacity: "400L",
                status: "60%",
                lastEmptied: "2025-03-16",
                features: ["Odor control", "Waterfront area"],
                iot: false
            },
            {
                id: 5,
                position: [10.0283, 76.3122],
                type: "general",
                name: "Railway Station Bin",
                capacity: "600L",
                status: "95%",
                lastEmptied: "2025-03-15",
                features: ["High traffic area", "Regular collection"],
                iot: false,
                alertStatus: "critical"
            },
            {
                id: 6,
                position: [10.0464, 76.3388],
                type: "smart",
                name: "Kaloor Smart Waste Station",
                capacity: "1000L",
                status: "25%",
                lastEmptied: "2025-03-17",
                features: ["Fill level sensor", "Compactor", "Wi-Fi hotspot", "Solar powered"],
                iot: true,
                battery: "30%",
                temperature: "30°C",
                humidity: "70%",
                alertStatus: "warning"
            },
            {
                id: 7,
                position: [9.9654, 76.2535],
                type: "recyclable",
                name: "Mattancherry Segregation Center",
                capacity: "700L",
                status: "50%",
                lastEmptied: "2025-03-16",
                features: ["Paper", "Plastic", "Metal", "Glass compartments"],
                iot: false
            },
            {
                id: 8,
                position: [10.0150, 76.3410],
                type: "organic",
                name: "Edappally Compost Bin",
                capacity: "450L",
                status: "75%",
                lastEmptied: "2025-03-17",
                features: ["Bioenzyme treatment", "Sealed design"],
                iot: false,
                alertStatus: "warning"
            },
            {
                id: 9,
                position: [9.9312, 76.2673],
                type: "general",
                name: "Willingdon Island Bin",
                capacity: "500L",
                status: "45%",
                lastEmptied: "2025-03-16",
                features: ["Port area", "Weekly collection"],
                iot: false
            },
            {
                id: 10,
                position: [10.0060, 76.3130],
                type: "smart",
                name: "High Court Smart Bin",
                capacity: "900L",
                status: "35%",
                lastEmptied: "2025-03-17",
                features: ["Fill level sensor", "CCTV monitoring", "UV sanitization"],
                iot: true,
                battery: "65%",
                temperature: "31°C",
                humidity: "60%",
                alertStatus: "warning"
            },
            {
                id: 11,
                position: [10.0320, 76.3080],
                type: "recyclable",
                name: "Panampilly Nagar Recycling Point",
                capacity: "650L",
                status: "55%",
                lastEmptied: "2025-03-16",
                features: ["Residential area", "E-waste collection"],
                iot: false
            },
            {
                id: 12,
                position: [10.0522, 76.3294],
                type: "organic",
                name: "Kadavanthra Bio Bin",
                capacity: "500L",
                status: "70%",
                lastEmptied: "2025-03-15",
                features: ["In-situ composting", "Commercial district"],
                iot: false,
                alertStatus: "warning"
            },
            {
                id: 13,
                position: [10.0006, 76.3052],
                type: "general",
                name: "Ernakulam Market Waste Bin",
                capacity: "700L",
                status: "85%",
                lastEmptied: "2025-03-15",
                features: ["Market area", "Daily collection"],
                iot: false,
                alertStatus: "warning"
            },
            {
                id: 14,
                position: [9.9745, 76.2779],
                type: "recyclable",
                name: "Vypeen Island Collection Point",
                capacity: "550L",
                status: "40%",
                lastEmptied: "2025-03-16",
                features: ["Coastal area", "Weekly collection"],
                iot: false
            },
            {
                id: 15,
                position: [10.0360, 76.3230],
                type: "smart",
                name: "Kakkanad Smart Waste System",
                capacity: "1200L",
                status: "30%",
                lastEmptied: "2025-03-17",
                features: ["Fill level sensor", "Compactor", "Solar powered", "GPS tracking"],
                iot: true,
                battery: "90%",
                temperature: "29°C",
                humidity: "55%"
            },
            
            // Additional 20 bins with diverse features and locations
            {
                id: 16,
                position: [10.0200, 76.3350],
                type: "smart",
                name: "InfoPark Smart Collection Unit",
                capacity: "1000L",
                status: "20%",
                lastEmptied: "2025-03-17",
                features: ["Fill level sensor", "Automated sorting", "E-waste specialized", "WiFi hotspot"],
                iot: true,
                battery: "95%",
                temperature: "28°C",
                humidity: "50%"
            },
            {
                id: 17,
                position: [10.0123, 76.3147],
                type: "general",
                name: "KSRTC Bus Station Bin",
                capacity: "700L",
                status: "65%",
                lastEmptied: "2025-03-16",
                features: ["High traffic area", "Twice daily collection"],
                iot: false
            },
            {
                id: 18,
                position: [9.9940, 76.2850],
                type: "recyclable",
                name: "Thevara Recyclables Hub",
                capacity: "800L",
                status: "45%",
                lastEmptied: "2025-03-16",
                features: ["Educational area", "Plastic and paper focus"],
                iot: false
            },
            {
                id: 19,
                position: [10.0080, 76.3180],
                type: "organic",
                name: "Menaka Organic Processor",
                capacity: "600L",
                status: "50%",
                lastEmptied: "2025-03-16",
                features: ["Commercial district", "Methane sensor"],
                iot: true,
                battery: "75%",
                temperature: "33°C",
                humidity: "70%"
            },
            {
                id: 20,
                position: [9.9900, 76.2920],
                type: "smart",
                name: "Thoppumpady Smart Junction",
                capacity: "900L",
                status: "15%",
                lastEmptied: "2025-03-17",
                features: ["Solar powered", "Compactor", "CCTV monitoring", "Road junction"],
                iot: true,
                battery: "80%",
                temperature: "30°C",
                humidity: "65%"
            },
            {
                id: 21,
                position: [10.0300, 76.3000],
                type: "general",
                name: "Palarivattom Junction Bin",
                capacity: "550L",
                status: "70%",
                lastEmptied: "2025-03-15",
                features: ["Traffic junction", "Regular collection"],
                iot: false,
                alertStatus: "warning"
            },
            {
                id: 22,
                position: [9.9880, 76.2730],
                type: "recyclable",
                name: "Naval Base Collection Center",
                capacity: "600L",
                status: "35%",
                lastEmptied: "2025-03-16",
                features: ["Military area", "Secured access"],
                iot: false
            },
            {
                id: 23,
                position: [10.0400, 76.3100],
                type: "organic",
                name: "Vyttila Mobility Hub Compost",
                capacity: "700L",
                status: "55%",
                lastEmptied: "2025-03-16",
                features: ["Transport hub", "Daily collection", "Sealed design"],
                iot: false
            },
            {
                id: 24,
                position: [10.0230, 76.3050],
                type: "smart",
                name: "GCDA Complex Intelligent Bin",
                capacity: "1100L",
                status: "40%",
                lastEmptied: "2025-03-17",
                features: ["Automated alerts", "Compactor", "Fill level sensor", "Public building"],
                iot: true,
                battery: "85%",
                temperature: "29°C",
                humidity: "60%"
            },
            {
                id: 25,
                position: [9.9680, 76.2430],
                type: "general",
                name: "Chinese Fishing Nets Area Bin",
                capacity: "450L",
                status: "85%",
                lastEmptied: "2025-03-15",
                features: ["Tourist area", "Waterproof design"],
                iot: false,
                alertStatus: "warning"
            },
            {
                id: 26,
                position: [10.0580, 76.3250],
                type: "recyclable",
                name: "Palarivattom Bypass Junction",
                capacity: "750L",
                status: "30%",
                lastEmptied: "2025-03-17",
                features: ["Highway adjacent", "Multi-material sorting"],
                iot: false
            },
            {
                id: 27,
                position: [10.0120, 76.3420],
                type: "organic",
                name: "Changampuzha Park Bio Bin",
                capacity: "500L",
                status: "60%",
                lastEmptied: "2025-03-16",
                features: ["Park area", "Leaf waste focus", "In-situ treatment"],
                iot: false
            },
            {
                id: 28,
                position: [10.0500, 76.3150],
                type: "smart",
                name: "Aluva Road Smart System",
                capacity: "950L",
                status: "25%",
                lastEmptied: "2025-03-17",
                features: ["Road junction", "Solar powered", "Fill level sensor", "Compactor"],
                iot: true,
                battery: "70%",
                temperature: "31°C",
                humidity: "55%"
            },
            {
                id: 29,
                position: [9.9950, 76.3020],
                type: "general",
                name: "General Hospital Waste Bin",
                capacity: "650L",
                status: "80%",
                lastEmptied: "2025-03-15",
                features: ["Hospital vicinity", "Daily collection", "Special handling"],
                iot: false,
                alertStatus: "warning"
            },
            {
                id: 30,
                position: [10.0170, 76.3090],
                type: "recyclable",
                name: "Ernakulam South Plastic Collector",
                capacity: "600L",
                status: "40%",
                lastEmptied: "2025-03-16",
                features: ["Railway area", "Plastic focused"],
                iot: false
            },
            {
                id: 31,
                position: [10.0440, 76.3350],
                type: "organic",
                name: "Palarivattom Shopping Mall Garden Waste",
                capacity: "550L",
                status: "45%",
                lastEmptied: "2025-03-16",
                features: ["Shopping complex", "Food waste", "Bioenzyme treatment"],
                iot: false
            },
            {
                id: 32,
                position: [9.9870, 76.2810],
                type: "smart",
                name: "Fort Kochi Beach Smart Bin",
                capacity: "800L",
                status: "70%",
                lastEmptied: "2025-03-15",
                features: ["Tourist beach", "Solar powered", "Compactor", "Waterproof design"],
                iot: true,
                battery: "55%",
                temperature: "32°C",
                humidity: "75%",
                alertStatus: "warning"
            },
            {
                id: 33,
                position: [10.0330, 76.3280],
                type: "general",
                name: "Edappally Toll Waste Station",
                capacity: "700L",
                status: "50%",
                lastEmptied: "2025-03-16",
                features: ["Highway toll plaza", "Regular collection"],
                iot: false
            },
            {
                id: 34,
                position: [10.0100, 76.2980],
                type: "smart",
                name: "Kerala High Court Smart Collector",
                capacity: "850L",
                status: "35%",
                lastEmptied: "2025-03-17",
                features: ["Paper waste focus", "Fill level sensor", "Government building"],
                iot: true,
                battery: "90%",
                temperature: "29°C",
                humidity: "60%"
            },
            {
                id: 35,
                position: [10.0420, 76.3180],
                type: "smart",
                name: "Kochi Metro Intelligent System",
                capacity: "1000L",
                status: "20%",
                lastEmptied: "2025-03-17",
                features: ["Metro station", "Automated alerts", "Solar powered", "Public WiFi"],
                iot: true,
                battery: "95%",
                temperature: "28°C",
                humidity: "55%"
            }
        ];
        
        // Calculate statistics
        const totalBins = wasteBins.length;
        const smartBins = wasteBins.filter(bin => bin.type === "smart").length;
        const binsNeedService = wasteBins.filter(bin => 
            parseInt(bin.status) >= 70
        ).length;
        
        // Update dashboard stats
        document.getElementById('total-bins').textContent = totalBins;
        document.getElementById('smart-bins').textContent = smartBins;
        document.getElementById('bins-need-service').textContent = binsNeedService;
        
        // Create bin icons for each type with animation for critical bins
        function createBinIcon(bin) {
            let color;
            let pulseEffect = '';
            
            // Set color based on bin type
            switch(bin.type) {
                case 'general':
                    color = '#689F38';
                    break;
                case 'recyclable':
                    color = '#43A047';
                    break;
                case 'organic':
                    color = '#7CB342';
                    break;
                case 'smart':
                    color = '#2E7D32';
                    break;
                default:
                    color = '#689F38';
            }
            
            // Add pulse effect for critical bins
            if (bin.alertStatus === 'critical' || parseInt(bin.status) >= 90) {
                pulseEffect = `<div class="marker-pulse" style="background-color: ${color};"></div>`;
            }
            
            let binIcon = '';
            switch(bin.type) {
                case 'general':
                    binIcon = 'trash';
                    break;
                case 'recyclable':
                    binIcon = 'recycle';
                    break;
                case 'organic':
                    binIcon = 'leaf';
                    break;
                case 'smart':
                    binIcon = 'microchip';
                    break;
                default:
                    binIcon = 'trash';
            }
            
            return L.divIcon({
                html: `${pulseEffect}<div style="background-color: ${color}; width: 14px; height: 14px; border-radius: 50%; border: 2px solid white; display: flex; align-items: center; justify-content: center;">
                      <i class="fas fa-${binIcon}" style="font-size: 8px; color: white;"></i></div>`,
                className: 'bin-marker',
                iconSize: [18, 18]
            });
        }
        
        // Function to create a popup content for waste bins
        function createBinPopup(bin) {
            let statusColor = "#8BC34A"; // Green for low fill
            let statusClass = "good";
            
            const fillLevel = parseInt(bin.status);
            
            if (fillLevel >= 90) {
                statusColor = "#FF5722"; // Red for nearly full
                statusClass = "critical";
            } else if (fillLevel >= 70) {
                statusColor = "#FFA000"; // Orange for medium fill
                statusClass = "warning";
            }
            
            let featuresHtml = '';
            bin.features.forEach(feature => {
                featuresHtml += `<span class="badge" style="background-color: #8BC34A;">${feature}</span> `;
            });
            
            let iotHtml = '';
            if (bin.iot) {
                iotHtml = `
                    <p><strong>IoT Status:</strong> 
                        <div style="display: flex; align-items: center; margin-top: 5px;">
                            <span class="status-icon" style="background-color: #4CAF50;"></span> 
                            <span>Online</span>
                        </div>
                    </p>
                    <p><strong>Battery:</strong> ${bin.battery}</p>
                    <p><strong>Sensors:</strong> Temp ${bin.temperature}, Humidity ${bin.humidity}</p>
                `;
            }
            
            let controlsHtml = '';
            if (bin.iot) {
                controlsHtml = `
                    <div class="bin-controls">
                        <button onclick="requestCollection('${bin.name}')" class="bounce-hover">
                            <i class="fas fa-truck"></i> Request Collection
                        </button>
                        <button onclick="viewLiveData('${bin.name}')" class="bounce-hover">
                            <i class="fas fa-chart-line"></i> Live Data
                        </button>
                    </div>
                `;
            }
            
            return `
                <div class="bin-popup">
                    <h3>
                        ${bin.name}
                        ${bin.iot ? '<i class="fas fa-wifi" title="IoT Enabled"></i>' : ''}
                    </h3>
                    <p><strong>Type:</strong> ${bin.type.charAt(0).toUpperCase() + bin.type.slice(1)} Waste</p>
                    <p><strong>Capacity:</strong> ${bin.capacity}</p>
                    <p>
                        <strong>Fill Level:</strong> 
                        <span class="status ${statusClass}">${bin.status}</span>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${bin.status}; background-color: ${statusColor};"></div>
                        </div>
                    </p>
                    <p><strong>Last Emptied:</strong> ${bin.lastEmptied}</p>
                    ${iotHtml}
                    <p><strong>Features:</strong><br>${featuresHtml}</p>
                    ${controlsHtml}
                </div>
            `;
        }
        
        // Create a layer group for waste bins
        const wasteBinLayerGroup = L.layerGroup();
        
        // Add waste bins to the map and populate bin list
        const binListContainer = document.getElementById('bin-list');
        
        wasteBins.forEach(bin => {
            // Create map marker
            const marker = L.marker(bin.position, {icon: createBinIcon(bin)})
                .bindPopup(createBinPopup(bin));
            
            wasteBinLayerGroup.addLayer(marker);
            
            // Add to sidebar bin list
            const fillLevel = parseInt(bin.status);
            let statusClass = "good";
            
            if (fillLevel >= 90) {
                statusClass = "critical";
            } else if (fillLevel >= 70) {
                statusClass = "warning";
            }
            
            const binItem = document.createElement('div');
            binItem.className = 'bin-list-item';
            binItem.innerHTML = `
                <div class="bin-name">
                    ${bin.iot ? '<i class="fas fa-wifi" style="margin-right: 5px;"></i>' : ''}
                    ${bin.name}
                </div>
                <div class="bin-status ${statusClass}">${bin.status}</div>
            `;
            
            binItem.addEventListener('click', function() {
                map.flyTo(bin.position, 17, {
                    duration: 1.5,
                    easeLinearity: 0.5
                });
                marker.openPopup();
                animateElement(this, 'pulse');
            });
            
            binListContainer.appendChild(binItem);
        });
        
        // Initially add the waste bin layer to the map
        wasteBinLayerGroup.addTo(map);
        
        // Add legend
        const legend = L.control({position: 'bottomleft'});
        legend.onAdd = function(map) {
            const div = L.DomUtil.create('div', 'legend');
            div.innerHTML = `
                <div style="font-weight: bold; margin-bottom: 8px;">Waste Bin Types</div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #689F38;"></div>
                    <div>General Waste</div>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #43A047;"></div>
                    <div>Recyclable Waste</div>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #7CB342;"></div>
                    <div>Organic Waste</div>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #2E7D32;"></div>
                    <div>Smart Bins</div>
                </div>
                <div style="margin-top: 10px; font-weight: bold;">Fill Levels</div>
                <div class="legend-item">
                    <div class="status-icon" style="background-color: #FF5722;"></div>
                    <div>Critical (90%+)</div>
                </div>
                <div class="legend-item">
                    <div class="status-icon" style="background-color: #FFA000;"></div>
                    <div>Warning (70-89%)</div>
                </div>
                <div class="legend-item">
                    <div class="status-icon" style="background-color: #8BC34A;"></div>
                    <div>Good (0-69%)</div>
                </div>
            `;
            return div;
        };
        legend.addTo(map);
        
        // Show/hide waste bins buttons
        document.getElementById('show-waste-bins').addEventListener('click', function() {
            map.addLayer(wasteBinLayerGroup);
            this.style.backgroundColor = '#4CAF50';
            document.getElementById('hide-waste-bins').style.backgroundColor = '#8BC34A';
            animateElement(this, 'pulse');
        });
        
        document.getElementById('hide-waste-bins').addEventListener('click', function() {
            map.removeLayer(wasteBinLayerGroup);
            this.style.backgroundColor = '#4CAF50';
            document.getElementById('show-waste-bins').style.backgroundColor = '#8BC34A';
            animateElement(this, 'pulse');
        });
        
        // Filter waste bins by type dropdown
        document.getElementById('bin-type').addEventListener('change', function(e) {
            const binType = e.target.value;
            
            // Clear existing bins
            wasteBinLayerGroup.clearLayers();
            
            // Add filtered bins
            wasteBins.forEach(bin => {
                if (binType === 'all' || bin.type === binType) {
                    const marker = L.marker(bin.position, {icon: createBinIcon(bin)})
                        .bindPopup(createBinPopup(bin));
                    wasteBinLayerGroup.addLayer(marker);
                }
            });
        });
        
        // Filter chip functionality for bin types
        document.querySelectorAll('.filter-chip[data-type]').forEach(chip => {
            chip.addEventListener('click', function() {
                const binType = this.getAttribute('data-type');
                
                // Update UI
                document.querySelectorAll('.filter-chip[data-type]').forEach(c => c.classList.remove('active'));
                this.classList.add('active');
                animateElement(this, 'pulse');
                
                // Clear bin list
                binListContainer.innerHTML = '';
                
                // Repopulate bin list with filtered bins
                wasteBins.forEach(bin => {
                    if (binType === 'all' || bin.type === binType) {
                        const fillLevel = parseInt(bin.status);
                        let statusClass = "good";
                        
                        if (fillLevel >= 90) {
                            statusClass = "critical";
                        } else if (fillLevel >= 70) {
                            statusClass = "warning";
                        }
                        
                        const binItem = document.createElement('div');
                        binItem.className = 'bin-list-item';
                        binItem.innerHTML = `
                            <div class="bin-name">
                                ${bin.iot ? '<i class="fas fa-wifi" style="margin-right: 5px;"></i>' : ''}
                                ${bin.name}
                            </div>
                            <div class="bin-status ${statusClass}">${bin.status}</div>
                        `;
                        
                        binItem.addEventListener('click', function() {
                            map.flyTo(bin.position, 17, {
                                duration: 1.5,
                                easeLinearity: 0.5
                            });
                            wasteBinLayerGroup.getLayers().forEach(layer => {
                                if (layer instanceof L.Marker && 
                                    layer.getLatLng().lat === bin.position[0] && 
                                    layer.getLatLng().lng === bin.position[1]) {
                                    layer.openPopup();
                                }
                            });
                            animateElement(this, 'pulse');
                        });
                        
                        binListContainer.appendChild(binItem);
                    }
                });
                
                // Also update the map
                wasteBinLayerGroup.clearLayers();
                wasteBins.forEach(bin => {
                    if (binType === 'all' || bin.type === binType) {
                        const marker = L.marker(bin.position, {icon: createBinIcon(bin)})
                            .bindPopup(createBinPopup(bin));
                        wasteBinLayerGroup.addLayer(marker);
                    }
                });
            });
        });
        
        // Filter chip functionality for alerts
        document.querySelectorAll('.filter-chip[data-filter]').forEach(chip => {
            chip.addEventListener('click', function() {
                const filterType = this.getAttribute('data-filter');
                
                // Update UI
                document.querySelectorAll('.filter-chip[data-filter]').forEach(c => c.classList.remove('active'));
                this.classList.add('active');
                animateElement(this, 'pulse');
                
                // Get all notification items
                const allNotifications = document.querySelectorAll('#all-notifications .notification-item');
                
                // Show/hide based on filter
                allNotifications.forEach(notification => {
                    const notificationText = notification.textContent.toLowerCase();
                    
                    if (filterType === 'all') {
                        notification.style.display = 'block';
                    } else if (filterType === 'capacity' && (notificationText.includes('capacity') || notificationText.includes('full'))) {
                        notification.style.display = 'block';
                    } else if (filterType === 'battery' && notificationText.includes('battery')) {
                        notification.style.display = 'block';
                    } else if (filterType === 'maintenance' && (notificationText.includes('maintenance') || notificationText.includes('sensor'))) {
                        notification.style.display = 'block';
                    } else {
                        notification.style.display = 'none';
                    }
                });
            });
        });
        
        // Bin search functionality
        document.getElementById('bin-search').addEventListener('keyup', function() {
            const searchTerm = this.value.toLowerCase();
            const binItems = document.querySelectorAll('.bin-list-item');
            
            binItems.forEach(item => {
                const binName = item.querySelector('.bin-name').textContent.toLowerCase();
                if (binName.includes(searchTerm)) {
                    item.style.display = 'flex';
                } else {
                    item.style.display = 'none';
                }
            });
        });
        
        // Initialize noUiSlider for urgency filter
        const urgencySlider = document.getElementById('urgency-slider');
        
        noUiSlider.create(urgencySlider, {
            start: [0],
            connect: 'lower',
            range: {
                'min': 0,
                'max': 100
            },
            step: 1,
            pips: {
                mode: 'positions',
                values: [0, 50, 100],
                density: 4
            }
        });
        
        urgencySlider.noUiSlider.on('update', function(values, handle) {
            const urgencyLevel = parseInt(values[handle]);
            const allNotifications = document.querySelectorAll('#all-notifications .notification-item');
            
            allNotifications.forEach(notification => {
                // Extract fill level if present
                const text = notification.textContent;
                const fillLevelMatch = text.match(/(\d+)%\s+capacity/);
                let fillLevel = 0;
                
                if (fillLevelMatch) {
                    fillLevel = parseInt(fillLevelMatch[1]);
                } else if (notification.classList.contains('urgent')) {
                    fillLevel = 90;
                } else if (notification.classList.contains('warning')) {
                    fillLevel = 70;
                } else {
                    fillLevel = 30;
                }
                
                if (fillLevel >= urgencyLevel) {
                    notification.style.display = 'block';
                } else {
                    notification.style.display = 'none';
                }
            });
        });
        
        // Create fill rate chart
        const ctx = document.getElementById('fill-rate-chart').getContext('2d');
        const dates = ['Apr 4', 'Apr 5', 'Apr 6', 'Apr 7', 'Apr 8', 'Apr 9', 'Apr 10'];
        
        const fillRateChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: dates,
                datasets: [
                    {
                        label: 'Average Fill Rate',
                        data: [30, 42, 55, 63, 70, 58, 45],
                        borderColor: '#4CAF50',
                        backgroundColor: 'rgba(76, 175, 80, 0.1)',
                        tension: 0.4,
                        fill: true
                    },
                    {
                        label: 'Collections',
                        data: [2, 3, 2, 4, 5, 3, 4],
                        borderColor: '#2196F3',
                        backgroundColor: 'rgba(33, 150, 243, 0.1)',
                        tension: 0.4,
                        fill: true
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                animations: {
                    tension: {
                        duration: 1000,
                        easing: 'linear',
                        from: 0.8,
                        to: 0.4,
                        loop: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Fill % / Collections',
                            color: getComputedStyle(document.documentElement).getPropertyValue('--text-color')
                        },
                        grid: {
                            color: 'rgba(200, 200, 200, 0.2)'
                        },
                        ticks: {
                            color: getComputedStyle(document.documentElement).getPropertyValue('--text-color')
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Date',
                            color: getComputedStyle(document.documentElement).getPropertyValue('--text-color')
                        },
                        grid: {
                            color: 'rgba(200, 200, 200, 0.2)'
                        },
                        ticks: {
                            color: getComputedStyle(document.documentElement).getPropertyValue('--text-color')
                        }
                    }
                },
                plugins: {
                    legend: {
                        position: 'top',
                        labels: {
                            color: getComputedStyle(document.documentElement).getPropertyValue('--text-color')
                        }
                    },
                    tooltip: {
                        backgroundColor: 'rgba(0, 0, 0, 0.7)',
                        titleFont: {
                            size: 14
                        },
                        bodyFont: {
                            size: 13
                        },
                        padding: 10,
                        caretSize: 5,
                        cornerRadius: 4
                    }
                }
            }
        });
        
        // Create waste trend chart
        const trendCtx = document.getElementById('waste-trend-chart').getContext('2d');
        const monthsData = ['Nov', 'Dec', 'Jan', 'Feb', 'Mar', 'Apr'];
        
        const wasteTrendChart = new Chart(trendCtx, {
            type: 'bar',
            data: {
                labels: monthsData,
                datasets: [
                    {
                        label: 'General Waste',
                        data: [0.7, 0.8, 0.7, 0.6, 0.5, 0.4],
                        backgroundColor: '#689F38',
                        borderRadius: 5
                    },
                    {
                        label: 'Recyclable Waste',
                        data: [0.3, 0.3, 0.4, 0.4, 0.5, 0.5],
                        backgroundColor: '#43A047',
                        borderRadius: 5
                    },
                    {
                        label: 'Organic Waste',
                        data: [0.2, 0.2, 0.3, 0.3, 0.4, 0.3],
                        backgroundColor: '#7CB342',
                        borderRadius: 5
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                animations: {
                    y: {
                        duration: 2000,
                        delay: (context) => context.dataIndex * 100
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        stacked: true,
                        title: {
                            display: true,
                            text: 'Tons',
                            color: getComputedStyle(document.documentElement).getPropertyValue('--text-color')
                        },
                        grid: {
                            color: 'rgba(200, 200, 200, 0.2)'
                        },
                        ticks: {
                            color: getComputedStyle(document.documentElement).getPropertyValue('--text-color')
                        }
                    },
                    x: {
                        stacked: true,
                        title: {
                            display: true,
                            text: 'Month',
                            color: getComputedStyle(document.documentElement).getPropertyValue('--text-color')
                        },
                        grid: {
                            color: 'rgba(200, 200, 200, 0.2)'
                        },
                        ticks: {
                            color: getComputedStyle(document.documentElement).getPropertyValue('--text-color')
                        }
                    }
                },
                plugins: {
                    legend: {
                        position: 'top',
                        labels: {
                            color: getComputedStyle(document.documentElement).getPropertyValue('--text-color')
                        }
                    },
                    tooltip: {
                        backgroundColor: 'rgba(0, 0, 0, 0.7)',
                        titleFont: {
                            size: 14
                        },
                        bodyFont: {
                            size: 13
                        },
                        padding: 10,
                        caretSize: 5,
                        cornerRadius: 4
                    }
                }
            }
        });
        
        // Create waste composition chart
        const compositionCtx = document.getElementById('composition-chart').getContext('2d');
        
        const compositionChart = new Chart(compositionCtx, {
            type: 'pie',
            data: {
                labels: ['General Waste', 'Recyclables', 'Organic Waste', 'E-Waste', 'Hazardous'],
                datasets: [{
                    data: [40, 28, 22, 8, 2],
                    backgroundColor: [
                        '#689F38',
                        '#43A047',
                        '#7CB342',
                        '#9CCC65',
                        '#C5E1A5'
                    ],
                    borderColor: 'white',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'right',
                        labels: {
                            color: getComputedStyle(document.documentElement).getPropertyValue('--text-color'),
                            font: {
                                size: 12
                            },
                            padding: 15
                        }
                    },
                    tooltip: {
                        backgroundColor: 'rgba(0, 0, 0, 0.7)',
                        titleFont: {
                            size: 14
                        },
                        bodyFont: {
                            size: 13
                        },
                        padding: 10,
                        callbacks: {
                            label: function(context) {
                                return context.label + ': ' + context.raw + '%';
                            }
                        }
                    }
                },
                animation: {
                    animateRotate: true,
                    animateScale: true
                }
            }
        });
        
        // Route optimization button
        document.getElementById('optimize-route').addEventListener('click', function() {
            // Show loading overlay
            loadingOverlay.classList.add('active');
            
            // Reset progress for route calculation
            progress = 0;
            progressBar.style.width = '0%';
            document.querySelector('.loading-text').textContent = 'Calculating optimal route...';
            updateProgress();
            
            // Simulate route calculation
            setTimeout(() => {
                // Get bins that need service (fill level > 70%)
                const binsNeedingService = wasteBins.filter(bin => parseInt(bin.status) >= 70);
                
                // Create a polyline for the route (simplified for demo)
                const routePoints = binsNeedingService.map(bin => bin.position);
                
                // Add starting point (municipality office)
                routePoints.unshift([10.0261, 76.3125]); // Marine Drive
                
                // Remove any existing route
                map.eachLayer(layer => {
                    if (layer instanceof L.Polyline && layer.options.className === 'collection-route') {
                        map.removeLayer(layer);
                    }
                });
                
                // Create the route line
                const route = L.polyline(routePoints, {
                    color: '#FF5722',
                    weight: 4,
                    opacity: 0.8,
                    dashArray: '10, 10',
                    className: 'collection-route'
                }).addTo(map);
                
                // Add route markers
                routePoints.forEach((point, index) => {
                    if (index > 0) { // Skip starting point
                        L.marker(point, {
                            icon: L.divIcon({
                                html: `<div style="background-color: #FF5722; width: 22px; height: 22px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 12px;">${index}</div>`,
                                className: 'route-marker',
                                iconSize: [22, 22]
                            })
                        }).addTo(map);
                    }
                });
                
                // Fit map to route
                map.fitBounds(route.getBounds(), { padding: [50, 50] });
                
                // Show route info
                document.getElementById('route-info').classList.add('active');
                
                // Update route text
                document.querySelector('.route-text').innerHTML = `
                    <strong>Optimal collection route:</strong> ${binsNeedingService.length} bins, ${(Math.random() * 10 + 10).toFixed(1)} km
                `;
                
                // Hide loading overlay
                loadingOverlay.classList.remove('active');
                
                // Animate route button
                animateElement(this, 'bounce');
                
                // Show real-time updates
                showRealTimeUpdate('Optimized route calculated. ETA: 3h 15m');
            }, 2000);
        });
        
        // Clear route button
        document.getElementById('clear-route').addEventListener('click', function() {
            // Remove route from map
            map.eachLayer(layer => {
                if (layer instanceof L.Polyline && layer.options.className === 'collection-route' ||
                    layer instanceof L.Marker && layer.options.icon && layer.options.icon.options.className === 'route-marker') {
                    map.removeLayer(layer);
                }
            });
            
            // Hide route info
            document.getElementById('route-info').classList.remove('active');
            
            // Animate button
            animateElement(this, 'pulse');
        });
        
        // IoT data simulation for smart bins
        function updateSmartBinData() {
            wasteBins.forEach(bin => {
                if (bin.iot) {
                    // Simulate small changes in fill level
                    const currentFill = parseInt(bin.status);
                    const fillChange = Math.random() > 0.7 ? Math.floor(Math.random() * 3) + 1 : 0;
                    
                    // Only increase fill level to simulate real waste accumulation
                    if (currentFill < 100) {
                        bin.status = `${Math.min(currentFill + fillChange, 100)}%`;
                    }
                    
                    // Update alert status
                    if (parseInt(bin.status) >= 90) {
                        bin.alertStatus = "critical";
                    } else if (parseInt(bin.status) >= 70) {
                        bin.alertStatus = "warning";
                    } else {
                        bin.alertStatus = "good";
                    }
                    
                    // Simulate battery drain
                    const currentBattery = parseInt(bin.battery);
                    if (currentBattery > 0) {
                        const batteryDrain = Math.random() > 0.8 ? 1 : 0;
                        bin.battery = `${Math.max(currentBattery - batteryDrain, 0)}%`;
                    }
                    
                    // Random temperature and humidity changes
                    const tempChange = (Math.random() - 0.5) * 0.5;
                    const currentTemp = parseInt(bin.temperature);
                    bin.temperature = `${(currentTemp + tempChange).toFixed(1)}°C`;
                    
                    const humidityChange = (Math.random() - 0.5) * 2;
                    const currentHumidity = parseInt(bin.humidity);
                    bin.humidity = `${Math.max(0, Math.min(100, Math.round(currentHumidity + humidityChange)))}%`;
                }
            });
            
            // Update bin markers and popups
            wasteBinLayerGroup.clearLayers();
            wasteBins.forEach(bin => {
                if (document.getElementById('bin-type').value === 'all' || 
                    document.getElementById('bin-type').value === bin.type) {
                    const marker = L.marker(bin.position, {icon: createBinIcon(bin)})
                        .bindPopup(createBinPopup(bin));
                    wasteBinLayerGroup.addLayer(marker);
                }
            });
            
            // Update bin list
            updateBinList();
            
            // Show real-time update occasionally
            if (Math.random() > 0.7) {
                const updateMsgs = [
                    "Lulu Mall Smart Bin fill level increased to 92%.",
                    "Battery level low (25%) at Kaloor Smart Waste Station.",
                    "Marine Drive bin sensors detecting unusual activity.",
                    "Route 3 collection vehicle is approaching Railway Station Bin.",
                    "System completed automatic diagnostics check.",
                    "Weather alert: Expected rain may affect collection schedules."
                ];
                
                const randomMsg = updateMsgs[Math.floor(Math.random() * updateMsgs.length)];
                showRealTimeUpdate(randomMsg);
            }
            
            // Schedule next update
            setTimeout(updateSmartBinData, 10000); // Update every 10 seconds
        }
        
        // Update bin list in sidebar
        function updateBinList() {
            const binListContainer = document.getElementById('bin-list');
            let selectedType = 'all';
            
            const activeChip = document.querySelector('.filter-chip[data-type].active');
            if (activeChip) {
                selectedType = activeChip.getAttribute('data-type');
            }
            
            // Clear current list
            binListContainer.innerHTML = '';
            
            // Repopulate list
            wasteBins.forEach(bin => {
                if (selectedType === 'all' || bin.type === selectedType) {
                    const fillLevel = parseInt(bin.status);
                    let statusClass = "good";
                    
                    if (fillLevel >= 90) {
                        statusClass = "critical";
                    } else if (fillLevel >= 70) {
                        statusClass = "warning";
                    }
                    
                    const binItem = document.createElement('div');
                    binItem.className = 'bin-list-item';
                    binItem.innerHTML = `
                        <div class="bin-name">
                            ${bin.iot ? '<i class="fas fa-wifi" style="margin-right: 5px;"></i>' : ''}
                            ${bin.name}
                        </div>
                        <div class="bin-status ${statusClass}">${bin.status}</div>
                    `;
                    
                    binItem.addEventListener('click', function() {
                        map.flyTo(bin.position, 17, {
                            duration: 1.5,
                            easeLinearity: 0.5
                        });
                        wasteBinLayerGroup.getLayers().forEach(layer => {
                            if (layer instanceof L.Marker && 
                                layer.getLatLng().lat === bin.position[0] && 
                                layer.getLatLng().lng === bin.position[1]) {
                                layer.openPopup();
                            }
                        });
                        animateElement(this, 'pulse');
                    });
                    
                    binListContainer.appendChild(binItem);
                }
            });
            
            // Update dashboard stats
            const binsNeedService = wasteBins.filter(bin => 
                parseInt(bin.status) >= 70
            ).length;
            
            document.getElementById('bins-need-service').textContent = binsNeedService;
            document.getElementById('alerts-count').textContent = binsNeedService;
        }
        
        // Dark mode toggle
        const darkModeToggle = document.getElementById('dark-mode-toggle');
        let darkModeActive = false;
        
        darkModeToggle.addEventListener('click', function() {
            darkModeActive = !darkModeActive;
            
            if (darkModeActive) {
                document.body.classList.add('dark-mode');
                darkModeToggle.innerHTML = '<i class="fas fa-sun"></i>';
            } else {
                document.body.classList.remove('dark-mode');
                darkModeToggle.innerHTML = '<i class="fas fa-moon"></i>';
            }
            
            // Update charts for dark mode
            updateChartsForTheme();
            
            animateElement(this, 'spin');
        });
        
        function updateChartsForTheme() {
            const textColor = getComputedStyle(document.documentElement).getPropertyValue('--text-color');
            const gridColor = darkModeActive ? 'rgba(200, 200, 200, 0.1)' : 'rgba(200, 200, 200, 0.2)';
            
            // Update fill rate chart
            fillRateChart.options.scales.y.ticks.color = textColor;
            fillRateChart.options.scales.y.title.color = textColor;
            fillRateChart.options.scales.y.grid.color = gridColor;
            fillRateChart.options.scales.x.ticks.color = textColor;
            fillRateChart.options.scales.x.title.color = textColor;
            fillRateChart.options.scales.x.grid.color = gridColor;
            fillRateChart.options.plugins.legend.labels.color = textColor;
            fillRateChart.update();
            
            // Update waste trend chart
            wasteTrendChart.options.scales.y.ticks.color = textColor;
            wasteTrendChart.options.scales.y.title.color = textColor;
            wasteTrendChart.options.scales.y.grid.color = gridColor;
            wasteTrendChart.options.scales.x.ticks.color = textColor;
            wasteTrendChart.options.scales.x.title.color = textColor;
            wasteTrendChart.options.scales.x.grid.color = gridColor;
            wasteTrendChart.options.plugins.legend.labels.color = textColor;
            wasteTrendChart.update();
            
            // Update composition chart
            compositionChart.options.plugins.legend.labels.color = textColor;
            compositionChart.update();
        }
        
        // Voice command functionality
        const voiceCommand = document.getElementById('voice-command');
        let voiceActive = false;
        
        voiceCommand.addEventListener('click', function() {
            voiceActive = !voiceActive;
            
            if (voiceActive) {
                this.classList.add('active');
                showNotification('Voice assistant activated. Try saying "Show full bins" or "Generate collection route".');
            } else {
                this.classList.remove('active');
                showNotification('Voice assistant deactivated.');
            }
        });
        
        // Floating buttons toggle
        const floatingToggle = document.getElementById('floating-toggle');
        const floatingButtons = document.querySelector('.floating-buttons');
        let floatingActive = false;
        
        floatingToggle.addEventListener('click', function() {
            floatingActive = !floatingActive;
            
            if (floatingActive) {
                this.classList.add('active');
                floatingButtons.classList.add('active');
            } else {
                this.classList.remove('active');
                floatingButtons.classList.remove('active');
            }
            
            animateElement(this, 'pulse');
        });
        
        // Notification button
        const notificationButton = document.getElementById('notification-button');
        const notificationsPanel = document.getElementById('notifications-panel');
        
        notificationButton.addEventListener('click', function() {
            notificationsPanel.classList.toggle('active');
            animateElement(this, 'tada');
        });
        
        document.getElementById('close-notifications').addEventListener('click', function() {
            notificationsPanel.classList.remove('active');
        });
        
        // Profile button
        const profileButton = document.getElementById('profile-button');
        const userProfile = document.getElementById('user-profile');
        
        profileButton.addEventListener('click', function() {
            userProfile.classList.toggle('active');
            animateElement(this, 'pulse');
        });
        
        // Click anywhere to close user profile
        document.addEventListener('click', function(event) {
            if (!profileButton.contains(event.target) && 
                !userProfile.contains(event.target) &&
                userProfile.classList.contains('active')) {
                userProfile.classList.remove('active');
            }
        });
        
        // Clear all alerts
        document.getElementById('clear-all-alerts').addEventListener('click', function() {
            const alerts = document.querySelectorAll('#all-notifications .notification-item');
            
            alerts.forEach((alert, index) => {
                setTimeout(() => {
                    animateElement(alert, 'fadeOutRight').then(() => {
                        alert.style.display = 'none';
                    });
                }, index * 100);
            });
            
            animateElement(this, 'pulse');
            
            setTimeout(() => {
                document.getElementById('alerts-count').textContent = '0';
            }, alerts.length * 100);
            
            showNotification('All alerts have been cleared.');
        });
        
        // Tour functionality
        document.getElementById('start-tour').addEventListener('click', function() {
            document.querySelector('.tour-overlay').classList.remove('active');
            startTour();
        });
        
        document.getElementById('skip-tour').addEventListener('click', function() {
            document.querySelector('.tour-overlay').classList.remove('active');
            
            // Show event popup after a delay
            setTimeout(() => {
                document.getElementById('event-popup').classList.add('active');
            }, 10000);
        });
        
        function startTour() {
            const tourStep1 = document.getElementById('tour-step-1');
            tourStep1.style.top = '200px';
            tourStep1.style.left = '300px';
            tourStep1.querySelector('.tour-arrow').style.top = '-7px';
            tourStep1.querySelector('.tour-arrow').style.left = '20px';
            tourStep1.classList.add('active');
            
            document.getElementById('next-step-1').addEventListener('click', function() {
                tourStep1.classList.remove('active');
                
                const tourStep2 = document.getElementById('tour-step-2');
                tourStep2.style.top = '200px';
                tourStep2.style.right = '380px';
                tourStep2.querySelector('.tour-arrow').style.top = '50%';
                tourStep2.querySelector('.tour-arrow').style.right = '-7px';
                tourStep2.classList.add('active');
            });
            
            document.getElementById('prev-step-2').addEventListener('click', function() {
                document.getElementById('tour-step-2').classList.remove('active');
                tourStep1.classList.add('active');
            });
            
            document.getElementById('next-step-2').addEventListener('click', function() {
                document.getElementById('tour-step-2').classList.remove('active');
                
                const tourStep3 = document.getElementById('tour-step-3');
                tourStep3.style.bottom = '100px';
                tourStep3.style.left = '50%';
                tourStep3.style.transform = 'translateX(-50%)';
                tourStep3.querySelector('.tour-arrow').style.bottom = '-7px';
                tourStep3.querySelector('.tour-arrow').style.left = '50%';
                tourStep3.classList.add('active');
            });
            
            document.getElementById('prev-step-3').addEventListener('click', function() {
                document.getElementById('tour-step-3').classList.remove('active');
                document.getElementById('tour-step-2').classList.add('active');
            });
            
            document.getElementById('next-step-3').addEventListener('click', function() {
                document.getElementById('tour-step-3').classList.remove('active');
                
                const tourStep4 = document.getElementById('tour-step-4');
                tourStep4.style.top = '100px';
                tourStep4.style.right = '30px';
                tourStep4.querySelector('.tour-arrow').style.top = '20px';
                tourStep4.querySelector('.tour-arrow').style.right = '-7px';
                tourStep4.classList.add('active');
            });
            
            document.getElementById('prev-step-4').addEventListener('click', function() {
                document.getElementById('tour-step-4').classList.remove('active');
                document.getElementById('tour-step-3').classList.add('active');
            });
            
            document.getElementById('finish-tour').addEventListener('click', function() {
                document.getElementById('tour-step-4').classList.remove('active');
                
                // Show event popup after tour
                setTimeout(() => {
                    document.getElementById('event-popup').classList.add('active');
                }, 2000);
            });
        }
        
        // Event popup
        document.getElementById('event-close').addEventListener('click', function() {
            document.getElementById('event-popup').classList.remove('active');
        });
        
        document.getElementById('event-join').addEventListener('click', function() {
            document.getElementById('event-popup').classList.remove('active');
            showNotification('Thanks for joining! We\'ll send you details about the cleanup event.');
        });
        
        document.getElementById('event-dismiss').addEventListener('click', function() {
            document.getElementById('event-popup').classList.remove('active');
        });
        
        // Theme selector functionality
        const themeToggle = document.getElementById('theme-toggle');
        const themeSelector = document.getElementById('theme-selector');
        
        themeToggle.addEventListener('click', function() {
            themeSelector.classList.toggle('active');
        });
        
        document.querySelectorAll('.theme-color').forEach(color => {
            color.addEventListener('click', function() {
                const theme = this.getAttribute('data-theme');
                
                // Remove active class from all colors
                document.querySelectorAll('.theme-color').forEach(c => c.classList.remove('active'));
                
                // Add active class to selected color
                this.classList.add('active');
                
                // Apply theme colors
                let primaryColor, primaryDark, primaryLight;
                
                switch(theme) {
                    case 'green':
                        primaryColor = '#4CAF50';
                        primaryDark = '#2E7D32';
                        primaryLight = '#8BC34A';
                        break;
                    case 'blue':
                        primaryColor = '#2196F3';
                        primaryDark = '#1565C0';
                        primaryLight = '#64B5F6';
                        break;
                    case 'purple':
                        primaryColor = '#9C27B0';
                        primaryDark = '#6A1B9A';
                        primaryLight = '#CE93D8';
                        break;
                    case 'orange':
                        primaryColor = '#FF9800';
                        primaryDark = '#E65100';
                        primaryLight = '#FFB74D';
                        break;
                }
                
                document.documentElement.style.setProperty('--primary-color', primaryColor);
                document.documentElement.style.setProperty('--primary-dark', primaryDark);
                document.documentElement.style.setProperty('--primary-light', primaryLight);
                
                // Update charts
                updateChartsForTheme();
            });
        });
        
        document.getElementById('theme-reset').addEventListener('click', function() {
            // Reset to default theme
            document.documentElement.style.setProperty('--primary-color', '#4CAF50');
            document.documentElement.style.setProperty('--primary-dark', '#2E7D32');
            document.documentElement.style.setProperty('--primary-light', '#8BC34A');
            
            // Reset active color
            document.querySelectorAll('.theme-color').forEach(c => c.classList.remove('active'));
            document.querySelector('.theme-color.green').classList.add('active');
            
            // Reset checkboxes
            document.getElementById('theme-animations').checked = false;
            document.getElementById('theme-contrast').checked = false;
            
            // Update charts
            updateChartsForTheme();
        });
        
        // Theme options
        document.getElementById('theme-animations').addEventListener('change', function() {
            if (this.checked) {
                document.documentElement.style.setProperty('--transition-speed', '0s');
            } else {
                document.documentElement.style.setProperty('--transition-speed', '0.3s');
            }
        });
        
        document.getElementById('theme-contrast').addEventListener('change', function() {
            if (this.checked) {
                document.documentElement.style.setProperty('--text-color', '#000000');
                document.documentElement.style.setProperty('--text-light', '#333333');
            } else {
                if (darkModeActive) {
                    document.documentElement.style.setProperty('--text-color', '#DCEDC8');
                    document.documentElement.style.setProperty('--text-light', '#AED581');
                } else {
                    document.documentElement.style.setProperty('--text-color', '#33691E');
                    document.documentElement.style.setProperty('--text-light', '#689F38');
                }
            }
            
            // Update charts
            updateChartsForTheme();
        });
        
        // Chat support functionality
        const chatToggle = document.getElementById('chat-toggle');
        const supportChat = document.getElementById('support-chat');
        const chatInput = document.getElementById('chat-input-field');
        const sendButton = document.getElementById('send-message');
        const chatMessages = document.getElementById('chat-messages');
        
        chatToggle.addEventListener('click', function() {
            supportChat.classList.add('active');
        });
        
        document.getElementById('close-chat').addEventListener('click', function() {
            supportChat.classList.remove('active');
        });
        
        document.getElementById('minimize-chat').addEventListener('click', function() {
            supportChat.classList.remove('active');
        });
        
        function sendChatMessage() {
            const message = chatInput.value.trim();
            
            if (message) {
                // Add user message
                const userMessage = document.createElement('div');
                userMessage.className = 'chat-message user';
                userMessage.textContent = message;
                chatMessages.appendChild(userMessage);
                
                // Clear input
                chatInput.value = '';
                
                // Auto-scroll to bottom
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                // Simulate bot response after a delay
                setTimeout(() => {
                    const responses = [
                        "I'll check the status of that bin right away.",
                        "The nearest collection vehicle is about 15 minutes away.",
                        "Would you like me to schedule a pick-up for that location?",
                        "I can see that this bin was last serviced yesterday.",
                        "Let me connect you with our maintenance team for further assistance.",
                        "Our records show this area is scheduled for collection tomorrow morning.",
                        "Thanks for reporting this issue. I've logged it in our system."
                    ];
                    
                    const botMessage = document.createElement('div');
                    botMessage.className = 'chat-message bot';
                    botMessage.textContent = responses[Math.floor(Math.random() * responses.length)];
                    chatMessages.appendChild(botMessage);
                    
                    // Auto-scroll to bottom
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }, 1000);
            }
        }
        
        sendButton.addEventListener('click', sendChatMessage);
        
        chatInput.addEventListener('keyup', function(e) {
            if (e.key === 'Enter') {
                sendChatMessage();
            }
        });
        
        // Feedback modal functionality
        const feedbackModal = document.getElementById('feedback-modal');
        const ratingStars = document.querySelectorAll('#rating-stars i');
        
        document.getElementById('help-button').addEventListener('click', function() {
            feedbackModal.classList.add('active');
        });
        
        document.getElementById('close-feedback').addEventListener('click', function() {
            feedbackModal.classList.remove('active');
        });
        
        document.getElementById('cancel-feedback').addEventListener('click', function() {
            feedbackModal.classList.remove('active');
        });
        
        document.getElementById('submit-feedback').addEventListener('click', function() {
            feedbackModal.classList.remove('active');
            showNotification('Thank you for your feedback! We appreciate your input.');
        });
        
        ratingStars.forEach(star => {
            star.addEventListener('mouseover', function() {
                const rating = parseInt(this.getAttribute('data-rating'));
                
                ratingStars.forEach(s => {
                    const starRating = parseInt(s.getAttribute('data-rating'));
                    if (starRating <= rating) {
                        s.classList.add('active');
                    } else {
                        s.classList.remove('active');
                    }
                });
            });
            
            star.addEventListener('mouseleave', function() {
                ratingStars.forEach(s => {
                    if (!s.classList.contains('selected')) {
                        s.classList.remove('active');
                    }
                });
            });
            
            star.addEventListener('click', function() {
                const rating = parseInt(this.getAttribute('data-rating'));
                
                ratingStars.forEach(s => {
                    const starRating = parseInt(s.getAttribute('data-rating'));
                    s.classList.remove('selected');
                    
                    if (starRating <= rating) {
                        s.classList.add('selected');
                        s.classList.add('active');
                    } else {
                        s.classList.remove('active');
                    }
                });
            });
        });
        
        // Mobile menu functionality
        document.querySelectorAll('.mobile-menu-item').forEach(item => {
            item.addEventListener('click', function() {
                // Remove active class from all items
                document.querySelectorAll('.mobile-menu-item').forEach(i => i.classList.remove('active'));
                
                // Add active class to clicked item
                this.classList.add('active');
                
                // Get the index of the clicked item
                const index = Array.from(this.parentNode.children).indexOf(this);
                
                // Trigger corresponding tab if applicable
                if (index >= 1 && index <= 4) {
                    document.querySelectorAll('.tab-button')[index-1].click();
                    sidebar.classList.remove('collapsed');
                }
            });
        });
        
        // Real-time updates
        const realTimeUpdates = document.getElementById('realtime-updates');
        const updateContent = document.getElementById('update-content');
        
        function showRealTimeUpdate(message) {
            updateContent.textContent = message;
            realTimeUpdates.classList.add('active');
            
            // Auto-hide after animation completes
            setTimeout(() => {
                realTimeUpdates.classList.remove('active');
            }, 8000);
        }
        
        // Waste Calculator functionality
        document.getElementById('calculate-reduction').addEventListener('click', function() {
            const currentWaste = parseFloat(document.getElementById('current-waste').value) || 0;
            const reductionTarget = parseFloat(document.getElementById('reduction-target').value) || 0;
            const timeframe = parseFloat(document.getElementById('timeframe').value) || 1;
            
            const weeklyReduction = (currentWaste * reductionTarget / 100) / timeframe;
            document.getElementById('reduction-result').textContent = `${weeklyReduction.toFixed(1)} kg`;
            
            animateElement(this, 'bounce');
        });
        
        // Quick access functionality
        document.querySelectorAll('.quick-access-item').forEach((item, index) => {
            item.addEventListener('click', function() {
                switch(index) {
                    case 0: // Create Route
                        document.getElementById('optimize-route').click();
                        break;
                    case 1: // Add Bin
                        document.getElementById('add-new-bin').click();
                        break;
                    case 2: // Export Data
                        document.getElementById('export-analytics').click();
                        break;
                    case 3: // Schedule
                        showNotification('Opening scheduling interface...');
                        break;
                }
                
                animateElement(this, 'pulse');
            });
        });
        
        // Chart controls
        document.querySelectorAll('.chart-control').forEach(control => {
            control.addEventListener('click', function() {
                // Remove active class from all controls
                document.querySelectorAll('.chart-control').forEach(c => c.classList.remove('active'));
                
                // Add active class to clicked control
                this.classList.add('active');
                
                // Update chart data based on period
                const period = this.getAttribute('data-period');
                updateChartData(period);
                
                animateElement(this, 'pulse');
            });
        });
        
        function updateChartData(period) {
            let labels, data1, data2, data3;
            
            switch(period) {
                case 'week':
                    labels = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
                    data1 = [0.3, 0.4, 0.35, 0.5, 0.45, 0.3, 0.2];
                    data2 = [0.2, 0.15, 0.25, 0.3, 0.2, 0.25, 0.15];
                    data3 = [0.1, 0.15, 0.1, 0.2, 0.15, 0.1, 0.05];
                    break;
                case 'month':
                    labels = ['Week 1', 'Week 2', 'Week 3', 'Week 4'];
                    data1 = [1.5, 1.7, 1.4, 1.3];
                    data2 = [1.1, 1.3, 1.5, 1.4];
                    data3 = [0.7, 0.6, 0.8, 0.9];
                    break;
                case 'year':
                    labels = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                    data1 = [5.8, 5.2, 5.5, 5.0, 4.8, 4.5, 4.3, 4.7, 4.9, 5.1, 5.4, 5.7];
                    data2 = [2.5, 2.7, 3.0, 3.2, 3.5, 3.8, 4.0, 4.2, 4.3, 4.5, 4.7, 4.8];
                    data3 = [1.2, 1.3, 1.5, 1.7, 1.9, 2.1, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8];
                    break;
            }
            
            // Update waste trend chart
            wasteTrendChart.data.labels = labels;
            wasteTrendChart.data.datasets[0].data = data1;
            wasteTrendChart.data.datasets[1].data = data2;
            wasteTrendChart.data.datasets[2].data = data3;
            wasteTrendChart.update();
        }
        
        // Custom notification function
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification-item info animate__animated animate__fadeInRight';
            notification.innerHTML = `
                ${message}
                <div class="time"><i class="fas fa-clock"></i> Just now</div>
            `;
            
            document.getElementById('all-notifications-panel').prepend(notification);
            
            // Auto close after 5 seconds
            setTimeout(() => {
                animateElement(notification, 'fadeOutRight').then(() => {
                    notification.remove();
                });
            }, 5000);
        }
        
        // Collection request function
        function requestCollection(binName) {
            showNotification(`Collection request submitted for ${binName}`);
        }
        
        // Live data view function
        function viewLiveData(binName) {
            showNotification(`Viewing live data for ${binName}`);
            
            // In a real app, this would open a detailed data view
            // For demo, we'll just switch to analytics tab
            document.querySelector('.tab-button[data-tab="analytics"]').click();
        }
        
        // Export analytics function
        document.getElementById('export-analytics').addEventListener('click', function() {
            showNotification('Exporting analytics report...');
            animateElement(this, 'pulse');
            
            setTimeout(() => {
                showNotification('Analytics report exported successfully!');
            }, 2000);
        });
        
        // Add new bin function
        document.getElementById('add-new-bin').addEventListener('click', function() {
            showNotification('New bin registration form opened.');
            animateElement(this, 'pulse');
            
            // In a real app, this would open a registration form
        });
        
        // Refresh data button
        document.getElementById('refresh-button').addEventListener('click', function() {
            showNotification('Refreshing all data...');
            animateElement(this, 'rotate');
            
            setTimeout(() => {
                updateBinList();
                showNotification('Data refreshed successfully!');
            }, 1000);
        });
        
        // Reports button
        document.getElementById('reports-button').addEventListener('click', function() {
            showNotification('Opening report submission form...');
            animateElement(this, 'pulse');
            
            // In a real app, this would open a report form
        });
        
        // Start IoT simulation after a delay
        setTimeout(() => {
            updateSmartBinData();
        }, 2000);
        
        // Initial map setup
        map.fitBounds(ernakulamBounds);
    </script>
</body>
</html>